function VASTController(a){this.url=a}function addJavaScriptElementWithSource(a,g){var e=document.createElement("script");e.src=a;e.async=g;document.head.appendChild(e)}
if(void 0===window.somaURLs){var urls=[];urls.push("http://soma.smaato.net/oapi/js/postscribe.js");urls.push("http://soma.smaato.net/oapi/js/htmlParser.js");urls.push("http://soma.smaato.net/oapi/js/smaato_adtag_bridge.js");urls.push("http://soma.smaato.net/oapi/js/ormma_bridge.js");urls.push("http://soma.smaato.net/oapi/js/ormma.js");urls.push("http://soma.smaato.net/oapi/js/smaato_mraid.js");for(var length=urls.length,i=0;i<length;i++)addJavaScriptElementWithSource(urls[i],!1);window.somaURLs=urls}
var client="adtag223",smaatoCallBack="",adDivId="",sessionID=null,userID=null,globalAdSpaceId=0,passback,formats=["img","txt","richmedia","all","vast"],dimensions="mma medrect leader sky widesky small large medium xlarge xxlarge full_320x480 full_480x320 full_640x960 full_960x640 full_1136x640 full_768x1024 full_1024x768 full_800x1280".split(" "),genders=["m","f","male","female"];void 0===window.smaatoConfigs&&(window.smaatoConfigs=[]);var smaato_isModalCSSLoaded=!1;
function smaato_hide_modal(a){var g=document.getElementById("smaato_modalAd");if(g){g.style.visibility="hidden";var e=g.parentElement;e&&("undefined"!=typeof smaatoConfigs[a]&&"function"==typeof smaatoConfigs[a].modalClosedCallback&&smaatoConfigs[a].modalClosedCallback(),e.removeChild(g))}}
function sizeForDimension(a){var g={width:0,height:0};"mma"==a?(g.width="300px",g.height="50px"):"medrect"==a?(g.width="300px",g.height="250px"):"xxlarge"==a?(g.width="320px",g.height="50px"):"xlarge"==a?(g.width="300px",g.height="50px"):"sky"==a?(g.width="120px",g.height="600px"):"widesky"==a?(g.width="160px",g.height="600px"):"leader"==a?(g.width="728px",g.height="90px"):"full_320x480"==a?(g.width="320px",g.height="480px"):"full_480x320"==a?(g.width="480px",g.height="320px"):"full_640x960"==a?(g.width=
"640px",g.height="960px"):"full_960x640"==a?(g.width="960px",g.height="640px"):"full_1136x640"==a?(g.width="1136px",g.height="640px"):"full_768x1024"==a?(g.width="768px",g.height="1024px"):"full_1024x768"==a?(g.width="1024px",g.height="768px"):"full_800x1280"==a?(g.width="800px",g.height="1280px"):"small"==a?(g.width="120px",g.height="20px"):"large"==a?(g.width="216px",g.height="36px"):"large"==a?(g.width="216px",g.height="36px"):"medium"==a&&(g.width="168px",g.height="68px");return g}
var SomaTag=new function(){function a(e,a,b){if(e){var g=64;e.style.fontSize=g+"px";var q=e.offsetWidth+1;for(!0==smaatoConfigs[a].modalDisplay&&(b=SomaTag.maximumModalWidth(a)-20);q>b;)g-=1,e.style.fontSize=g+"px",q=e.offsetWidth;e.style.fontSize=g-2+"px"}}function g(e,a){for(var b=a.length,g=0;g<b;++g){var q=document.createElement("img");q.setAttribute("alt","");q.setAttribute("width","1px");q.setAttribute("height","1px");q.style.display="none";q.src=a[g];e.appendChild(q)}}this.showModal=function(e){if(!1==
smaato_isModalCSSLoaded){smaato_isModalCSSLoaded=!0;var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href","http://soma.smaato.net/oapi/js/smaatoAdTag.css");document.getElementsByTagName("head")[0].appendChild(a)}if(a=document.getElementById("smaato_modalAd")){a.innerHTML="";var b=a.parentElement;b&&b.removeChild(a)}a="";"TXT"==smaatoConfigs[e].adType&&(a="smaato_modalDialog_Gradient");b=" onClick=\"smaato_hide_modal('"+e+"')\" ";
"RICHMEDIA"==smaatoConfigs[e].adType&&(b="");a='<div id="smaato_modalAd" class="smaato_modalDialog">             <div id="smaato_modal_container" class="'+a+'" '+b+'\t><span id="closeButton" onClick="smaato_hide_modal(\''+e+'\')" title="Close" class="smaato_close">X</span>                             </div>        </div>';b=document.createElement("div");b.innerHTML=a;document.body.appendChild(b.firstChild);a=document.getElementById("smaato_modal_container");"mma"==smaatoConfigs[e].dimension?(a.style.width=
"300px",a.style.height="50px"):"medrect"==smaatoConfigs[e].dimension?(a.style.width="300px",a.style.height="250px"):"xxlarge"==smaatoConfigs[e].dimension?(a.style.width="320px",a.style.height="50px"):"xlarge"==smaatoConfigs[e].dimension?(a.style.width="300px",a.style.height="50px"):"sky"==smaatoConfigs[e].dimension?(a.style.width="120px",a.style.height="600px"):"widesky"==smaatoConfigs[e].dimension?(a.style.width="160px",a.style.height="600px"):"leader"==smaatoConfigs[e].dimension?(a.style.width=
"728px",a.style.height="90px"):"full_320x480"==smaatoConfigs[e].dimension?(a.style.width="320px",a.style.height="480px"):"full_480x320"==smaatoConfigs[e].dimension?(a.style.width="480px",a.style.height="320px"):"full_640x960"==smaatoConfigs[e].dimension?(a.style.width="640px",a.style.height="960px"):"full_960x640"==smaatoConfigs[e].dimension?(a.style.width="960px",a.style.height="640px"):"full_1136x640"==smaatoConfigs[e].dimension?(a.style.width="1136px",a.style.height="640px"):"full_768x1024"==smaatoConfigs[e].dimension?
(a.style.width="768px",a.style.height="1024px"):"full_1024x768"==smaatoConfigs[e].dimension?(a.style.width="1024px",a.style.height="768px"):"full_800x1280"==smaatoConfigs[e].dimension?(a.style.width="800px",a.style.height="1280px"):"small"==smaatoConfigs[e].dimension?(a.style.width="120px",a.style.height="20px"):"large"==smaatoConfigs[e].dimension?(a.style.width="216px",a.style.height="36px"):"medium"==smaatoConfigs[e].dimension&&(a.style.width="168px",a.style.height="68px")};this.maximumModalWidth=
function(a){if(smaatoConfigs[a].width)return smaatoConfigs[a].width;if("mma"==smaatoConfigs[a].dimension||"medrect"==smaatoConfigs[a].dimension)return 300;if("xxlarge"==smaatoConfigs[a].dimension)return 320;if("xlarge"==smaatoConfigs[a].dimension)return 300;if("sky"==smaatoConfigs[a].dimension)return 120;if("widesky"==smaatoConfigs[a].dimension)return 160;if("leader"==smaatoConfigs[a].dimension)return 728;if("full_320x480"==smaatoConfigs[a].dimension)return 320;if("full_480x320"==smaatoConfigs[a].dimension)return 480;
if("full_640x960"==smaatoConfigs[a].dimension)return 640;if("full_960x640"==smaatoConfigs[a].dimension)return 960;if("full_1136x640"==smaatoConfigs[a].dimension)return 1136;if("full_768x1024"==smaatoConfigs[a].dimension)return 768;if("full_1024x768"==smaatoConfigs[a].dimension)return 1024;if("full_800x1280"==smaatoConfigs[a].dimension)return 800;if("small"==smaatoConfigs[a].dimension)return 120;if("large"==smaatoConfigs[a].dimension)return 216;if("medium"==smaatoConfigs[a].dimension)return 168};this.displayImageAd=
function(a){var h=document.createElement("a");h.href=a.target;h.rel="external";h.target="_blank";var b=document.createElement("img");b.src=a.link;var f=a.width;SomaJS.checkNotNull(f)&&(b.style.width=f);f=a.height;SomaJS.checkNotNull(f)&&(b.style.height=f);if(!0===smaatoConfigs[a.divid].modalDisplay)!1!==smaatoConfigs[a.divid].shouldShowModalCallback&&!0!=smaatoConfigs[a.divid].shouldShowModalCallback()||b.addEventListener("load",function(f){SomaTag.showModal(a.divid);adDivId="smaato_modal_container";
f=document.getElementById(adDivId);f.style["text-align"]="center";h.appendChild(b);f.appendChild(h);g(f,a.beacons)});else{for(f=document.getElementById(a.divid);f.hasChildNodes();)f.removeChild(f.lastChild);f.style["text-align"]="center";h.appendChild(b);f.appendChild(h);g(f,a.beacons)}};this.displayTextAd=function(e){if(!0===smaatoConfigs[e.divid].modalDisplay){if(smaatoConfigs[e.divid].shouldShowModalCallback&&!0==smaatoConfigs[e.divid].shouldShowModalCallback()){var h=document.createElement("div");
h.style.padding="0px";document.body.appendChild(h);var b=document.createElement("style");b.type="text/css";b.innerHTML="div.textBanner {\nwhite-space: nowrap;\nmargin: 0px;\npadding: 0px;\nbackground: #f2f5f0; /* Old browsers */\nbackground: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f2f5f0), color-stop(18%,#e9ece7), color-stop(71%,#bdc1bb), color-stop(94%,#aeb2ab), color-stop(100%,#acb0a9)); /* Chrome,Safari4+ */\nbackground: -webkit-linear-gradient(top, #f2f5f0 0%,#e9ece7 18%,#bdc1bb 71%,#aeb2ab 94%,#acb0a9 100%); /* Chrome10+,Safari5.1+ */\nbackground: linear-gradient(top, #f2f5f0 0%,#e9ece7 18%,#bdc1bb 71%,#aeb2ab 94%,#acb0a9 100%); /* W3C */\n}\ndiv.textBannerHidden {\n opacity:0; position: absolute;\nwhite-space: nowrap;\nmargin: 0px;\npadding: 0px;\n}";
h.appendChild(b);b=document.createElement("div");b.className="textBannerHidden";b.innerHTML=e.text;b.onclick=function(){window.open(e.target,"_blank")};h.appendChild(b);a(b,e.divid,window.innerWidth);SomaTag.showModal(e.divid);adDivId="smaato_modal_container";var f=document.getElementById(adDivId);g(f,e.beacons);b.className="smaatoElement";f.appendChild(b);(b=h.parentElement)&&b.removeChild(h)}}else{h=document.getElementById(e.divid);h.innerHTML="";b=document.createElement("style");b.type="text/css";
b.innerHTML="div.smaatoContainer {\nwhite-space: nowrap;\nmargin: 0px;\npadding: 0px;\nbackground: #f2f5f0; /* Old browsers */\nbackground: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f2f5f0), color-stop(18%,#e9ece7), color-stop(71%,#bdc1bb), color-stop(94%,#aeb2ab), color-stop(100%,#acb0a9)); /* Chrome,Safari4+ */\nbackground: -webkit-linear-gradient(top, #f2f5f0 0%,#e9ece7 18%,#bdc1bb 71%,#aeb2ab 94%,#acb0a9 100%); /* Chrome10+,Safari5.1+ */\nbackground: linear-gradient(top, #f2f5f0 0%,#e9ece7 18%,#bdc1bb 71%,#aeb2ab 94%,#acb0a9 100%); /* W3C */\n}\ndiv.textBannerHidden {\n opacity:0; position: absolute;\nwhite-space: nowrap;\nmargin: 0px;\npadding: 0px;\n}";
h.appendChild(b);b=document.createElement("style");b.type="text/css";b.innerHTML="div.smaatoTextBanner {position: relative;top: 50%;-webkit-transform: translateY(-50%);-ms-transform: translateY(-50%);transform: translateY(-50%);text-align: center;white-space: nowrap;\n}";h.appendChild(b);b=document.createElement("div");b.className="textBannerHidden";b.innerHTML=e.text;b.onclick=function(){window.open(e.target,"_blank")};var f=document.createElement("div"),q=sizeForDimension(smaatoConfigs[e.divid].dimension);
0===q.width&&(q.width=h.style.width,q.height=h.style.height);f.style.width=q.width;f.style.height=q.height;f.appendChild(b);f.className="smaatoContainer";h.appendChild(f);a(b,e.divid,parseInt(f.style.width));b.className="smaatoTextBanner";g(f,e.beacons)}};this.displayRichMediaAd=function(a){var h=document.getElementById(a.divid);if(!0===smaatoConfigs[a.divid].modalDisplay)smaatoConfigs[a.divid].shouldShowModalCallback&&!0==smaatoConfigs[a.divid].shouldShowModalCallback()?(SomaTag.showModal(a.divid),
adDivId="smaato_modal_container",h=document.getElementById(adDivId)):h=null;else for(;h.hasChildNodes();)h.removeChild(h.lastChild);if(null!==h&&null!==a.mediadata){g(h,a.beacons);if(void 0==window.postscribe){var b=document.createElement("script");b.src="http://soma.smaato.net/oapi/js/postscribe.js";b.async=!0;b.onload=function(){postscribe("#"+h.id,a.mediadata)};document.head.appendChild(b)}else postscribe("#"+h.id,a.mediadata);return!0}return!1};this.displayAd=function(a){if("ERROR"==a.status){try{smaatoConfigs[a.divid].lastAd=
!1}catch(g){}try{try{smaatoConfigs[a.divid].callback(a.status)}catch(b){void 0!==window.somaLastCallback&&window.somaLastCallback(a.status)}if(passback)if(void 0==postscribe){var f=document.createElement("script");f.src="http://soma.smaato.net/oapi/js/postscribe.js";f.async=!0;f.onload=function(){postscribe("#"+adDivId,passback)};document.head.appendChild(f)}else postscribe("#"+adDivId,passback)}catch(q){console.error("CallBack function failed "+q)}}else{try{smaatoConfigs[a.divid].lastAd=a,smaatoConfigs[a.divid].callback(a.status)}catch(p){}smaatoConfigs[a.divid].adType=
a.type;!0===smaatoConfigs[a.divid].shouldCacheModal?smaatoConfigs[a.divid].lastAd=a:"IMG"==a.type?SomaTag.displayImageAd(a):"TXT"==a.type?SomaTag.displayTextAd(a):"RICHMEDIA"==a.type&&SomaTag.displayRichMediaAd(a)}};this.setGeoLocation=function(a){execTime=Date.now()-execTime;SomaJS.createCookieOneHour("geoExecutionTime",execTime,1);locationScriptLoaded=!0;SomaJS.checkNotNull(a.latitude)&&SomaJS.checkNotNull(a.longitude)&&(SomaJS.createCookieOneHour("smtlatitude",a.latitude),SomaJS.createCookieOneHour("smtlongitude",
a.longitude));SomaJS.checkNotNull(a.countryCode)&&SomaJS.createCookieOneHour("smtcoutrycode",a.countryCode);SomaJS.checkNotNull(a.countryName)&&SomaJS.createCookieOneHour("smtcountryname",a.countryName);SomaJS.checkNotNull(a.region)&&SomaJS.createCookieOneHour("smtregion",a.region);SomaJS.checkNotNull(a.city)&&SomaJS.createCookieOneHour("smtcity",a.city);SomaJS.checkNotNull(a.postalCode)&&SomaJS.createCookieOneHour("smtpostalcode",a.postalCode);smaatogeo=a}},SomaJS=new function(){this.cb=[Math.random().toString(16).slice(2,
10),Math.random().toString(16).slice(2,6),(0.0625*Math.random()+0.25).toString(16).slice(2,6),(0.25*Math.random()+0.5).toString(16).slice(2,6),Math.random().toString(16).slice(2,14)].join("");this.checkNotNull=function(a){return null!=a&&void 0!=a&&"null"!=a};this.isCorrectFormat=function(a){a=a.toLowerCase();if(-1<formats.indexOf(a))return!0;console.error(a+" is a wrong format, please use "+formats);return!1};this.isCorrectDimension=function(a){a=a.toLowerCase();if(-1<dimensions.indexOf(a))return!0;
console.error(a+" is a wrong dimension, please use "+dimensions);return!1};this.getValidGender=function(a){if(SomaJS.checkNotNull(a)){a=a.toLowerCase();if(-1<genders.indexOf(a))return"male"==a||"m"==a?"m":"f";console.error(a+" is a wrong gender, please use "+genders)}return""};this.isAndroidDevice=function(){return-1<navigator.userAgent.indexOf("Android")?!0:!1};this.isCorrectLatitude=function(a){return-90<=a&&90>=a?!0:!1};this.isCorrectLongitude=function(a){return-180<=a&&180>=a?!0:!1};this.isAppleDevice=
function(){return-1<navigator.userAgent.indexOf("Apple")?!0:!1};this.getLocationFromSmt=function(a){if(SomaJS.isCookiePresent("smtlatitude")||SomaJS.isCookiePresent("lastGeoCall")){var g="",g="",e=SomaJS.readCookie("smtlatitude"),h=SomaJS.readCookie("smtlongitude");SomaJS.checkNotNull(e)&&SomaJS.checkNotNull(h)&&(g=g+("&gps="+e)+(","+h));SomaJS.checkNotNull(a.countryCode)||(e=SomaJS.readCookie("smtcoutrycode"),SomaJS.checkNotNull(e)&&(g+="&countrycode="+e));SomaJS.checkNotNull(a.country)||(e=SomaJS.readCookie("smtcountryname"),
SomaJS.checkNotNull(e)&&(g+="&country="+e));e=SomaJS.readCookie("smtregion");SomaJS.checkNotNull(e)&&(g+="&region="+e);SomaJS.checkNotNull(a.city)||(e=SomaJS.readCookie("smtcity"),SomaJS.checkNotNull(e)&&(g+="&city="+e));SomaJS.checkNotNull(a.zip)||(a=SomaJS.readCookie("smtpostalcode"),SomaJS.checkNotNull(a)&&(g+="&zip="+a));return g}execTime=Date.now();SomaJS.isCookiePresent("geoExecutionTime")?(g=readCookie("geoExecutionTime"),addJavaScriptElementWithSource("http://geo.smaato.net:8080/client_server.location?adspace="+
globalAdSpaceId+"&client="+client+"&gt="+g,!0),eraseCookie("geoExecutionTime"),createCookieOneHour("lastGeoCall",Date.now())):(addJavaScriptElementWithSource("http://geo.smaato.net:8080/client_server.location?adspace="+globalAdSpaceId+"&client="+client,!0),SomaJS.createCookieOneHour("lastGeoCall",Date.now()));return""};this.readCookie=function(a){try{a+="=";for(var g=document.cookie.split(";"),e=0;e<g.length;e++){for(var h=g[e];" "==h.charAt(0);)h=h.substring(1,h.length);if(0==h.indexOf(a))return h.substring(a.length,
h.length)}}catch(b){}return null};this.isCookiePresent=function(a){a=SomaJS.readCookie(a);return null!=a&&void 0!=a&&""!=a?!0:!1};this.createCookieOneHour=function(a,g){try{if(g&&null!=g&&void 0!=g){var e=new Date,h=e.getTime();e.setTime(h+72E5);document.cookie=a+"="+g+"; expires="+e.toUTCString()+"; path=/"}}catch(b){}};this.presentModal=function(a){if(!0==smaatoConfigs[a].modalDisplay&&!0==smaatoConfigs[a].shouldCacheModal&&!1!=smaatoConfigs[a].lastAd&&!0==SomaJS.checkNotNull(smaatoConfigs[a].lastAd)){var g=
smaatoConfigs[a].lastAd;"IMG"==g.type?SomaTag.displayImageAd(g):"TXT"==g.type?SomaTag.displayTextAd(g):"RICHMEDIA"==g.type&&SomaTag.displayRichMediaAd(g);smaatoConfigs[a].lastAd=!1}else console.log("SOMA> Modal presentation not possible")};this.loadAd=function(a,g){function e(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function h(a,b,e){try{if(e){var g=new Date;g.setTime(g.getTime()+864E5*e);var f="; expires="+
g.toGMTString()}else f="";document.cookie=a+"="+b+f+"; path=/"}catch(h){}}void 0===window.somaLastCallback&&(window.somaLastCallback=g);smaatoCallBack=g;adDivId=a.adDivId;var b="http://soma.smaato.net/oapi/reqAd.jsp?";smaatoConfigs[adDivId]={};smaatoConfigs[adDivId].callback=g;smaatoConfigs[adDivId].shouldShowModalCallback=!1;smaatoConfigs[adDivId].modalClosedCallback=!1;smaatoConfigs[adDivId].shouldCacheModal=!1;var f=a.dimension;SomaJS.checkNotNull(f)&&SomaJS.isCorrectDimension(f)?smaatoConfigs[adDivId].dimension=
f:smaatoConfigs[adDivId].dimension="mma";smaatoConfigs[adDivId].modalDisplay=!0===a.modalDisplay;!0===smaatoConfigs[adDivId].modalDisplay&&(a.shouldShowModal&&(smaatoConfigs[adDivId].shouldShowModalCallback=a.shouldShowModal),a.modalClosedCallback&&(smaatoConfigs[adDivId].modalClosedCallback=a.modalClosedCallback),!0===a.shouldCacheModal&&(smaatoConfigs[adDivId].shouldCacheModal=!0));var q=a.publisherId,b=SomaJS.checkNotNull(q)?b+("pub="+q):b+"pub=0";SomaJS.checkNotNull(a.adDivId)&&(b+="&divid="+
a.adDivId,somaLastDivId=a.adDivId);q=a.adSpaceId;SomaJS.checkNotNull(q)?(b+="&adspace="+q,globalAdSpaceId=q):b+="&adspace=0";q=a.format;b=SomaJS.checkNotNull(q)&&SomaJS.isCorrectFormat(q)?b+("&format="+q):b+"&format=all";"vast"==q&&(b+="&vastver=2");var f=a.formatstrict,b=SomaJS.checkNotNull(f)?b+("&formatstrict="+f):b+"&formatstrict=false",p=f=0;SomaJS.checkNotNull(a.width)&&(f=parseInt(a.width),SomaJS.checkNotNull(a.height)&&(p=parseInt(a.height)));var C=2;if(SomaJS.checkNotNull(a.mraidver)){var K=
parseInt(a.mraidver);3>K&&(C=K)}b+="&mraidver="+C;SomaJS.checkNotNull(a.ref)&&(b+="&ref="+a.ref);0<f&&0<p?(b=b+("&width="+f)+("&height="+p),smaatoConfigs[adDivId].width=f,smaatoConfigs[adDivId].height=p):(f=a.dimension,SomaJS.checkNotNull(f)&&SomaJS.isCorrectDimension(f)?(b+="&dimension="+f,smaatoConfigs[adDivId].dimension=f):(b+="&dimension=mma",smaatoConfigs[adDivId].dimension="mma"));f=a.dimensionstrict;b=SomaJS.checkNotNull(f)?b+("&dimensionstrict="+f):!0===a.modalDisplay?b+"&dimensionstrict=true":
b+"&dimensionstrict=false";f=a.age;SomaJS.checkNotNull(f)&&(b+="&age="+f);f=a.city;SomaJS.checkNotNull(f)&&(b+="&city="+f);f=a.zip;SomaJS.checkNotNull(f)&&(b+="&zip="+f);f=a.country;SomaJS.checkNotNull(f)&&(b+="&country="+f);f=a.countryCode;SomaJS.checkNotNull(f)&&(b+="&countryCode="+f);f=SomaJS.getValidGender(a.gender);0<f.length&&(b+="&gender="+f);f=a.qs;SomaJS.checkNotNull(f)&&(b+="&qs="+f);f="";SomaJS.checkNotNull(a.keywordSearch)&&(f+=a.keywordSearch);SomaJS.checkNotNull(a.keywords)&&(f+=","+
a.keywords);""!=f&&(b+="&kws="+f);f=a.latitude;p=a.longitude;C=a.useLocation;SomaJS.checkNotNull(f)&&SomaJS.checkNotNull(p)?SomaJS.isCorrectLatitude(f)&&SomaJS.isCorrectLongitude(p)?(b+="&gps="+f+","+p,b+="&geotype=3"):console.error("Incorrect GPS values"):C&&(SomaJS.checkNotNull(SomaJS.lastHTML5Location)&&(b+="&gps="+SomaJS.lastHTML5Location.latitude+","+SomaJS.lastHTML5Location.longitude,b+="&geotype=1"),navigator.geolocation.getCurrentPosition(function(a){SomaJS.lastHTML5Location=a.coords}));sessionID||
(sessionID=SomaJS.readCookie("SomaSession"));sessionID||(sessionID=e(),h("SomaSession",sessionID,0));b+="&session="+sessionID;userID||(userID=SomaJS.readCookie("SomaUser"));userID||(userID=e(),h("SomaUser",userID,365));b+="&atuid="+userID;SomaJS.checkNotNull(a.did)&&(SomaJS.isAndroidDevice()?40==a.did.length?(a.udid=a.did,a.iosadtracking=a.diddnt):16==a.did.length?(a.androidid=a.did,a.googlednt=a.diddnt):36==a.did.length&&(a.googleadid=a.did,a.googlednt=a.diddnt):SomaJS.isAppleDevice()&&(a.iosadid=
a.did,a.iosadtracking=a.diddnt));a.macmd5&&(b+="&macmd5="+a.macmd5);a.odin&&(b+="&odin="+a.odin);a.openudid&&(b+="&openudid="+a.openudid);a.iosadid&&(b+="&iosadid="+a.iosadid);a.iosadtracking?b+="&iosadtracking=true":"undefined"!=typeof a.iosadtracking&&(b+="&iosadtracking=false");a.imei&&(b+="&imei="+a.imei);a.googleadid&&(b+="&googleadid="+a.googleadid);a.googlednt?b+="&googlednt=true":"undefined"!=typeof a.googlednt&&(b+="&googlednt=false");a.androidid&&(b+="&androidid="+a.androidid);a.coppa&&
(b+="&coppa="+a.coppa);b=a.cb?b+("&cb="+a.cb):b+("&cb="+this.cb);SomaJS.checkNotNull(a.autoReload)?(f=a.autoReload,10>f?(console.warn("Minimal auto reload time is 10 seconds. Automatically setting timer to 10 seconds"),f=10):240<f&&(console.warn("Maximal auto reload time is 240 seconds. Automatically setting timer to 240 seconds"),f=240),setTimeout(function(){SomaJS.loadAd(a,g)},1E3*f)):SomaJS.checkNotNull(a.autoRefresh)?(f=a.autoRefresh,10>f?(console.warn("Minimal auto reload time is 10 seconds. Automatically setting timer to 10 seconds"),
f=10):240<f&&(console.warn("Maximal auto reload time is 240 seconds. Automatically setting timer to 240 seconds"),f=240),setTimeout(function(){SomaJS.loadAd(a,g)},1E3*f)):SomaJS.checkNotNull(a.autorefresh)?(f=a.autorefresh,10>f?(console.warn("Minimal auto reload time is 10 seconds. Automatically setting timer to 10 seconds"),f=10):240<f&&(console.warn("Maximal auto reload time is 240 seconds. Automatically setting timer to 240 seconds"),f=240),setTimeout(function(){SomaJS.loadAd(a,g)},1E3*f)):SomaJS.checkNotNull(a.autoreload)&&
(f=a.autoreload,10>f?(console.warn("Minimal auto reload time is 10 seconds. Automatically setting timer to 10 seconds"),f=10):240<f&&(console.warn("Maximal auto reload time is 240 seconds. Automatically setting timer to 240 seconds"),f=240),setTimeout(function(){SomaJS.loadAd(a,g)},1E3*f));passback=a.passback;b+="&apiver=500";if("vast"==q)if(void 0==document.evaluate)smaatoCallBack(!1);else{var b=b+("&response=XML&client="+client),b=b+"&connection=wifi",A=new VASTController(b);A.adDivId=a.adDivId;
A.loadCallback=function(b){b?(d.dump(smaatoCallBack),smaatoCallBack(!0),!0===a.inlineVideo?(A.isInLine=!0,A.showInline(a.adDivId)):(A.isInLine=!1,A.show())):(d.log("Ad Load: FAILED"),smaatoCallBack(!1))};A.load()}else b+="&response=JSONP&client="+client,q=document.createElement("script"),q.src=b,document.getElementById(adDivId).appendChild(q)}};VASTController.prototype.isIEParser=!1;VASTController.prototype.xpathImpression="/VAST//Impression";VASTController.prototype.xpathMediaFiles="/VAST//Linear//MediaFile";
VASTController.prototype.xpathDuration="/VAST//Linear//Duration";VASTController.prototype.xpathTrackingEventURL="/VAST//Linear//TrackingEvents/Tracking";VASTController.prototype.xpathTrackingEventsTime="/VAST//Linear//TrackingEvents/Tracking/@event";VASTController.prototype.xpathVideoClickThroughURL="/VAST//Linear//VideoClicks/ClickThrough";VASTController.prototype.xpathVideoClickTracking="/VAST//Linear//VideoClicks/ClickTracking";VASTController.prototype.xpathWrapper="/VAST//Wrapper/VASTAdTagURI";
VASTController.prototype.xpathCompanionAd="/VAST//InLine//CompanionAds/Companion";VASTController.prototype.xpathBeacon="//beacon";VASTController.prototype.mediaFiles=[];VASTController.prototype.duration=null;VASTController.prototype.trackingEvents={};VASTController.prototype.videoClickThroughURLList=[];VASTController.prototype.videoClickTrackingURLList=[];VASTController.prototype.beacons=[];VASTController.prototype.videoPlayer=function(){return document.getElementById("_smaato_vast_video_Player")};
VASTController.prototype.closeButton=function(){return document.getElementById("_smaato_vast_close")};VASTController.prototype.isVisible=!1;VASTController.prototype.isAdAvailable=!1;VASTController.prototype.isSkippable=!1;VASTController.prototype.companionAds=[];
VASTController.prototype.reset=function(){this.mediaFiles=[];this.duration=null;this.trackingEvents={};this.videoClickThroughURLList=[];this.videoClickTrackingURLList=[];this.beacons=[];this.isSkippable=this.isAdAvailable=this.isVisible=!1;this.skipButtonTimer=void 0};
VASTController.prototype.initialize=function(){d.log("<<<<<<<< INITIALIZE >>>>> ");this.reset();var a=document.getElementById("__SMAATO_CSS_VAST__");d.dump(a);void 0==a&&(d.log("Adding CSS"),a=document.createElement("style"),a.type="text/css",a.id="__SMAATO_CSS_VAST__",a.innerHTML=this.popupCSS,document.getElementsByTagName("head")[0].appendChild(a));void 0==document.getElementById("__smaato_vast_div__")&&(a=document.createElement("div"),a.id="__smaato_vast_div__",a.className="_smaato_modal",a.innerHTML=
this.popupHTML,document.body.appendChild(a),a=this.closeButton(),self=this,a.addEventListener("click",function(){self.isSkippable&&self.hide()}))};
VASTController.prototype.showInline=function(){var a=document.getElementById(this.adDivId);if(void 0!=a){this.isVisible=!0;a.innerHTML="";var g=document.createElement("div");g.style.width="100%";g.style.height="100%";g.style.position="relative";a.appendChild(g);var e=this,h=this.trackingEvents.impression;if(void 0!=h)for(var b=0;b<h.length;b++)e.callTrackingURL(h[b]);h=this.trackingEvents.creativeView;if(void 0!=h)for(b=0;b<h.length;b++)e.callTrackingURL(h[b]);var f=document.createElement("video");
f.style.height="100%";f.style.width="100%";f.autoplay=!0;f.controls=!0;f.style.backgroundColor="#000000";g.appendChild(f);f.innerHTML="Your browser does not support HTML5 video.";this.mediaFiles.forEach(function(a){var b=document.createElement("source");b.src=a.url;b.type=a.type;f.appendChild(b);e.isVisible=!0});f.load();f.play();f.addEventListener("click",function(){!1==e.isVisible?d.log("VIDEO IS NOT VISIBLE"):(e.hide(!0),0<e.videoClickThroughURLList.length&&(d.dump(e.videoClickThroughURLList),
d.dump(e.videoClickThroughURLList[0]),window.open(e.videoClickThroughURLList[0]),e.videoClickTrackingURLList.forEach(function(a){e.callTrackingURL(a)})))});f.onended=function(a){e.fireTrackingEvent("complete");e.hide()};f.ontimeupdate=function(a){a=Math.floor(f.currentTime/f.duration*100/25);var b=["start","firstQuartile","midpoint","thirdQuartile"][a];d.log("Current time: ("+a+") "+b);e.fireTrackingEvent(b)};g=document.createElement("div");g.style.bottom="0px";g.style.position="absolute";g.style.width=
a.style.width;g.style.height=a.style.height}};
VASTController.prototype.show=function(){if(!1!=this.isAdAvailable){this.firefoxVideoPlayerCurrentTimeFlag=!1;var a=document.getElementById("__smaato_vast_modal__");if(void 0!=a){var g=this;a.className="_smaato_modal__overlay_visible";var e=this.trackingEvents.impression;if(void 0!=e)for(a=0;a<e.length;a++)g.callTrackingURL(e[a]);e=this.trackingEvents.creativeView;if(void 0!=e)for(a=0;a<e.length;a++)g.callTrackingURL(e[a]);var h=this.videoPlayer();h.innerHTML="Your browser does not support HTML5 video.";
this.mediaFiles.forEach(function(a){var b=document.createElement("source");b.src=a.url;b.type=a.type;a=a.width;var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;e<a&&(a=e-30);h.width=a;h.appendChild(b);g.isVisible=!0});h.load();h.play();h.addEventListener("click",function(){!1==g.isVisible?d.log("VIDEO IS NOT VISIBLE"):(g.hide(!0),0<g.videoClickThroughURLList.length&&(d.dump(g.videoClickThroughURLList),d.dump(g.videoClickThroughURLList[0]),window.open(g.videoClickThroughURLList[0]),
g.videoClickTrackingURLList.forEach(function(a){g.callTrackingURL(a)})))});h.onended=function(a){g.fireTrackingEvent("complete");g.hide()};h.ontimeupdate=function(a){a=Math.floor(h.currentTime/h.duration*100/25);var b=["start","firstQuartile","midpoint","thirdQuartile"][a];d.log("Current time: ("+a+") "+b);g.fireTrackingEvent(b)};var b=document.getElementById("_smaato_vast_close");b.style.display="none";b.addEventListener("click",function(){g.isSkippable&&g.hide()});h.onplaying=function(){if(void 0==
g.skipButtonTimer){d.log("Configuring skip timer...");b.style.display="inline";var a=0;this.isSkippable=!1;var e=function(){d.log("Tick:"+a);b.textContent=3-a;a++;4>a?g.skipButtonTimer=setTimeout(e,1E3):(b.textContent="X",g.isSkippable=!0)};e()}};a=document.getElementById("_smaato_vast_companion_ad_");this.createCompanionElement(a);this.willShowCallback&&this.willShowCallback()}}};
VASTController.prototype.createCompanionElement=function(a){a.innerHTML="";var g;if(0==this.companionAds.length)a.style.height="0px",a.style.width="0px",a.innerHTML="";else{var e=this.companionAds[0];if("staticresource"==e.resourceType.toLowerCase()){var h=document.createElement("img");h.src=e.resourceValue;h.style.height=e.height+"px";h.style.width=e.width+"px";g=h;var b=this;h.onclick=function(){!1==b.isVisible?q.log("COMPANION AD CLICK: VIDEO IS NOT VISIBLE"):(window.open(e.clickThrough),b.hide())};
a.appendChild(h)}else"htmlresource"==e.resourceType.toLowerCase()?(h=document.createElement("div"),h.innerHTML=e.resourceValue,h.style.height=e.height+"px",h.style.width=e.width+"px",g=h,b=this,h.onclick=function(){!1==b.isVisible?q.log("COMPANION AD CLICK: VIDEO IS NOT VISIBLE"):(b.callTrackingURL(e.clickThrough),b.hide())},a.appendChild(h)):"iframeresource"==e.resourceType.toLowerCase()&&(h=document.createElement("IFRAME"),h.frameBorder=0,h.setAttribute("src",e.resourceValue),h.style.height=e.height+
"px",h.style.width=e.width+"px",g=h,b=this,h.onclick=function(){!1==b.isVisible?q.log("COMPANION AD CLICK: VIDEO IS NOT VISIBLE"):(b.callTrackingURL(e.clickThrough),b.hide())},a.appendChild(h));var h=a.style.width,f=a.style.height;if(SomaJS.checkNotNull(h))parseInt(g.style.width)>parseInt(h)&&(g.style.width=h),parseInt(g.style.height)>parseInt(f)&&(g.style.height=f+"px");else{console.log("companionAdDiv");a.style.height=e.height+"px";a.style.width=e.width+"px";console.log(">>companionAdDiv");var q=
0/0}}};VASTController.prototype.hide=function(a){clearTimeout(this.skipButtonTimer);if(!0!=this.isInLine){this.isAdAvailable=this.isVisible=!1;var g=document.getElementById("__smaato_vast_modal__");if(void 0!=g){g.className="_smaato_modal__overlay";g=this.videoPlayer();g.pause();g.innerHTML="Your browser does not support HTML5 video.";this.fireTrackingEvent("close");var e=!0===a,h=this;setTimeout(function(){h.didHideCallback&&h.didHideCallback(e)},300)}}};
VASTController.prototype.fireTrackingEvent=function(a){var g=this.trackingEvents[a],e=this;void 0!=g&&0<g.length&&(d.log("TRACK EVENT:"+a),g.forEach(function(a){e.callTrackingURL(a)}));this.trackingEvents[a]=[]};
VASTController.prototype.parseFinished=function(){d.log("");d.log("");d.log(">>> PARSE FINISHED <<<");d.log("");d.log("");d.log("MediaFile:"+this.mediaFile);d.log("Duration:"+this.duration);d.log(">> TrackingEvents:");d.dump(this.trackingEvents);d.log("<< TrackingEvents");d.log("");d.log("Video Clickthrough:"+this.videoClickThroughURLList);d.log(">> Beacons:");d.dump(this.beacons);d.log("<< Beacons");d.log("");d.log("");d.log(">> Companion Ads:");d.dump(this.companionAds);d.log("<< Companion Ads");
d.log("");d.log("");d.log("<<< ---- >>>");d.log("");d.log("");0<this.mediaFiles.length&&(this.isAdAvailable=!0);this.loadCallback&&this.loadCallback(this.isAdAvailable)};
VASTController.prototype.load=function(a){void 0==a&&(a=this.url,this.initialize());d.log("loading: "+a);var g=new XMLHttpRequest;if(g){d.log("XMLHttpRequest created");var e=this;g.onreadystatechange=function(){4==g.readyState&&(200==g.status?e.parse(g.responseXML):(d.err("url loading failed! GET:"+g.status+" "+a),e.loadCallback(!1)))};g.open("GET",a,!0);g.send()}else d.err("XMLHttpRequest couldn't be created!")};
VASTController.prototype.callTrackingURL=function(a){void 0==a||null==a||3>a.length||(d.log("Track URL: "+a),(new Image).src=a)};VASTController.prototype.parse=function(a){try{this.parseMediaFiles(a),this.parseDuration(a),this.parseTrackingEvents(a),this.parseImpressions(a),this.parseVideoClickThroughURL(a),this.parseBeacons(a),this.parseVideoClickTrackingURL(a),this.parseCompanionAds(a),this.parseWrapper(a)}catch(g){d.dump(g),this.loadCallback(!1)}};
VASTController.prototype.parseImpressions=function(a){a=this.runXpath(a,this.xpathImpression);void 0==this.trackingEvents.impression&&(this.trackingEvents.impression=[]);for(var g=0;g<a.length;g++)this.trackingEvents.impression.push(a[g]);d.dump(this.trackingEvents)};
VASTController.prototype.parseCompanionAds=function(a){var g=this.xpathCompanionAd;d.log("Running XPATH:"+g);var e=[];a=a.evaluate(g,a,null,XPathResult.ANY_TYPE,null);for(var h=a.iterateNext();h;){var g={resourceType:"unknown",creativeType:"unknown"},b=h.attributes;if(void 0==b||null==b)b=[];for(var f=0;f<b.length;f++)g[b.item(f).nodeName]=b.item(f).nodeValue;h=h.children;if(void 0==h||null==h)h=[];for(f=0;f<h.length;f++){b=h[f];if("staticresource"==b.nodeName.toLowerCase()||"htmlresource"==b.nodeName.toLowerCase()||
"iframeresource"==b.nodeName.toLowerCase())g.resourceType=b.nodeName.toLowerCase(),g.resourceValue=b.textContent.trim(),0<b.attributes.length&&(g.creativeType=b.attributes.item(0).nodeValue);"companionclickthrough"==b.nodeName.toLowerCase()&&(g.clickThrough=b.textContent.trim());if("trackingevents"==b.nodeName.toLowerCase()){b=b.children;if(void 0==b||null==b)b=[];for(var q=[],f=0;f<b.length;f++)q.push(b[f].textContent.trim());g.events=q}}"htmlresource"!=g.resourceType.toLowerCase()&&"iframeresource"!=
g.resourceType.toLowerCase()&&0!=g.creativeType.indexOf("image/")||e.push(g);h=a.iterateNext()}this.companionAds=e};VASTController.prototype.parseWrapper=function(a){a=this.runXpath(a,this.xpathWrapper);0<a.length?(a=a.pop(),this.load(a)):this.parseFinished()};VASTController.prototype.parseDuration=function(a){this.duration=this.runXpath(a,this.xpathDuration).pop()};VASTController.prototype.parseBeacons=function(a){a=this.runXpath(a,this.xpathBeacon);this.beacons=this.beacons.concat(a)};
VASTController.prototype.parseVideoClickThroughURL=function(a){a=this.runXpath(a,this.xpathVideoClickThroughURL).pop();d.log("URL = ");d.dump(a);void 0!=a&&this.videoClickThroughURLList.push(a)};VASTController.prototype.parseVideoClickTrackingURL=function(a){a=this.runXpath(a,this.xpathVideoClickTracking);for(var g=0;g<a.length;g++)this.videoClickTrackingURLList.push(a[g])};
VASTController.prototype.parseTrackingEvents=function(a){var g=this.runXpath(a,this.xpathTrackingEventsTime),e=this.trackingEvents;g.forEach(function(a){void 0==e[a]&&(e[a]=[])});a=this.runXpath(a,this.xpathTrackingEventURL);for(var h=0;h<a.length;h++)this.trackingEvents[g[h]].push(a[h]);d.dump(this.trackingEvents)};VASTController.prototype.parseMediaFiles=function(a){a=this.getXpathNodes(a,this.xpathMediaFiles);d.dump(a);this.mediaFiles=a};
VASTController.prototype.getXMLDoc=function(a){var g=null;window.DOMParser?g=(new DOMParser).parseFromString(a,"text/xml"):(this.isIEParser=!0,g=new ActiveXObject("Microsoft.XMLDOM"),g.async=!1,g.loadXML(a));return null==g||void 0==g?(d.err("Failed to read xml response"),null):g};
VASTController.prototype.getXpathNodes=function(a,g){d.log("Running XPATH:"+g);for(var e=[],h=a.evaluate(g,a,null,XPathResult.ANY_TYPE,null),b=h.iterateNext();b;){var f={};f.url=b.textContent.trim();b=b.attributes;if(void 0==b||null==b)b=[];for(var q=0;q<b.length;q++)f[b.item(q).nodeName]=b.item(q).nodeValue;e.push(f);b=h.iterateNext()}return e};
VASTController.prototype.runXpath=function(a,g){d.log("Running XPATH:"+g);for(var e=[],h=a.evaluate(g,a,null,XPathResult.ANY_TYPE,null),b=h.iterateNext();b;)e.push(b.textContent.trim()),b=h.iterateNext();return e};VASTController.prototype.popupHTML='        <div class="_smaato_modal__overlay" id ="__smaato_vast_modal__">         <label id = "_smaato_vast_close" class=\'smaato_close\'>X</label>             <div class="_smaato_modal__box">                 <video width="400" id = "_smaato_vast_video_Player" autoplay preload=true controls>                         Your browser does not support HTML5 video.                 </video>            </div>             <div id="_smaato_vast_companion_ad_" style="bottom: 0px;left:50%;transform:translate(-50%,0);position:absolute;"></div>         </div>         ';
VASTController.prototype.popupCSS="._smaato_modal { display: block; padding: 0 1em; text-align: center; width: 100%; }  @media (min-width: 43.75em) {  ._smaato_modal {         padding: 1em 2em;         text-align: right;     } }  ._smaato_modal > #_smaato_vast_close {     background: #606061;     color: #FFFFFF;     line-height: 25px;     position: absolute;     right: 0px;     text-align: center;     top: 0px;     width: 24px;     text-decoration: none;     font-weight: bold;     -webkit-border-radius: 12px;     -moz-border-radius: 12px;     border-radius: 12px;     -moz-box-shadow: 1px 1px 3px #000;     -webkit-box-shadow: 1px 1px 3px #000;    box-shadow: 1px 1px 3px #000;     cursor: hand;     z-index:1000;}._smaato_modal > #_smaato_vast_close:hover {     -webkit-transform: scale(0.97);     -ms-transform: scale(0.97);     transform: scale(0.97); }  ._smaato_modal input {     position: absolute;     right: 100px;     top: 30px;     z-index: -10; }  ._smaato_modal__overlay {     background: black;     bottom: 0;     left: 0;     position: fixed;     right: 0;     text-align: center;     top: 0;     z-index: -800; }  ._smaato_modal__box {     padding: 1em .75em;     position: relative;     margin: 1em auto;     width: 90%; }  @media (min-height: 37.5em) {  ._smaato_modal__box {         left: 50%;         position: absolute;         top: 50%;         -webkit-transform: translate(-50%, -50%);         -ms-transform: translate(-50%, -50%);         transform: translate(-50%, -50%);     } }  @media (min-width: 50em) {  ._smaato_modal__box { padding: 1.75em; } }  ._smaato_modal__box #_smaato_vast_close {     background: #606061;     color: #FFFFFF;     line-height: 25px;     position: absolute;     right: 0px;     text-align: center;     top: 0px;     width: 24px;     text-decoration: none;     font-weight: bold;     -webkit-border-radius: 12px;     -moz-border-radius: 12px;     border-radius: 12px;     -moz-box-shadow: 1px 1px 3px #000;     -webkit-box-shadow: 1px 1px 3px #000;    box-shadow: 1px 1px 3px #000;     cursor: hand;     z-index:1000;}  ._smaato_modal__box h2 {     color: #FFDE16;     margin-bottom: 1em;     text-transform: uppercase; }  .modal__box p {     color: #FFDE16;     text-align: left; }  ._smaato_modal__overlay {     opacity: 0;     overflow: hidden;     -webkit-transform: scale(0.5);     -ms-transform: scale(0.5);     transform: scale(0.5);     -webkit-transition: all 0.75s cubic-bezier(0.19, 1, 0.22, 1);     transition: all 0.75s cubic-bezier(0.19, 1, 0.22, 1); }  ._smaato_modal__overlay_visible {     background: black;     bottom: 0;     left: 0;     position: fixed;     right: 0;     text-align: center;     top: 0;     z-index: -800;     opacity: 1;     -webkit-transform: scale(1);     -ms-transform: scale(1);     transform: scale(1);     -webkit-transition: all 0.75s cubic-bezier(0.19, 1, 0.22, 1);     transition: all 0.75s cubic-bezier(0.19, 1, 0.22, 1);     z-index: 800; } ._smaato_modal__overlay_visible #_smaato_vast_close {     background: #606061;     color: #FFFFFF;     line-height: 25px;     position: absolute;     right: 0px;     text-align: center;     top: 0px;     width: 24px;     text-decoration: none;     font-weight: bold;     -webkit-border-radius: 12px;     -moz-border-radius: 12px;     border-radius: 12px;     -moz-box-shadow: 1px 1px 3px #000;     -webkit-box-shadow: 1px 1px 3px #000;    box-shadow: 1px 1px 3px #000;     cursor: hand;     z-index:1000;}  #_smaato_vast_close:hover {     -webkit-transform: scale(0.97);     -ms-transform: scale(0.97);     transform: scale(0.97); }";
var d={prefix:"VAST",enabled:!0,err:function(a){this._(this.prefix+": ERROR> ",a)},log:function(a){this._(this.prefix+": INFO> ",a)},dump:function(a){this.enabled&&console.log(a)},_:function(a,g){this.enabled&&console.log(a+": "+g)},enabled:!1};
XPathJS=function(){var a,g,e,h,b,f,q,p,C,K,A,U=[],z,w,v,t,s,X,O=function(a){return a.ownerDocument},$=function(a){var b=[],k=function(a,N){var b,k,c=[];for(k=0;k<a.length;k++)b=a.item(k),!1!==Z(b.nodeType,N)&&c.push(b);return c};switch(a.nodeType){case 1:b=k(a.childNodes,supportedChildNodeTypes=[1,3,4,7,8]);break;case 9:b=k(a.childNodes,supportedChildNodeTypes=[1,7,8]);break;case 2:case 3:case 4:case 7:case 8:case 13:break;default:throw Error("Internal Error: nodeChildren - unsupported node type: "+
a.nodeType);}return b},E=function(a){var b,k=[];a=$(a);for(b=0;b<a.length;b++)k.push(a[b]),k.push.apply(k,E(a[b]));return k},G=function(a){var b;switch(a.nodeType){case 1:case 3:case 4:case 7:case 8:case 9:return a.parentNode;case 2:return a.ownerElement?a.ownerElement:b=aa(a.ownerDocument,!0,function(b,Y){if(Y===a)return!0});case 13:return a.ownerElement;default:throw Error("Internal Error: nodeParent - node type not supported: "+a.type);}},P=function(a){for(var b=[];a=G(a);)b.push(a);return b},
H=function(a,b){for(var k,e=[];k=a[b];){switch(k.nodeType){case 1:case 3:case 4:case 7:case 8:case 9:e.push(k)}a=k}return e},O=function(a){switch(a.nodeType){case 9:return a;default:return a.ownerDocument}},Q=function(a){var b=[],k;if(1===a.nodeType)for(k=0;k<a.attributes.length;k++)a.attributes[k].specified&&b.push(a.attributes[k]);1<b.length&&b[0].compareDocumentPosition&&b.sort(function(a,b){var N=a.compareDocumentPosition(b);return 2==(N&2)?1:4==(N&4)?-1:0});return b},M=function(a){a=Q(a);var b=
[],k;for(k=0;k<a.length;k++)!1===L(a[k])&&b.push(a[k]);return b},D=function(a,b){var k=b||[],e,g,f;if(1===a.nodeType){if(a.ownerDocument.documentElement===a&&"object"===typeof a.ownerDocument.namespaces)for(g=a.ownerDocument.namespaces.length-1;0<=g;g--)e=a.ownerDocument.namespaces.item(g),I.call(this,k,e.name,e.urn,a);e=Q(a);for(g=e.length-1;0<=g;g--)!1!==(f=L(e[g]))&&(1===f.length?I.call(this,k,"",e[g].nodeValue,a):I.call(this,k,f[1],e[g].nodeValue,a));D.call(this,a.parentNode,k);void 0===b&&(I.call(this,
k,"xml","http://www.w3.org/XML/1998/namespace",a),k[0]&&""===k[0].prefix&&""===k[0].namespaceURI&&k.shift());if(void 0===b)for(g=0;g<k.length;g++)k[g].ownerElement!==a&&(k[g]=ba(k[g].prefix,k[g].nodeValue,a))}return k},I=function(a,b,k,e){var g;this.opts["case-sensitive"]||(b=b.toLowerCase());for(g=0;g<a.length;g++)if(a[g].prefix===b)return!1;e=ba(b,k,e);""===b&&null!==k?a.unshift(e):a.push(e);return!0},L=function(a){a=a.nodeName.split(":");return"xmlns"===a[0]?a:!1},W=function(a,b){var k,e,g,f,h,
c;if(1===a.nodeType)for(g=b?[b]:M(a),f=D.call(this,a),k=0;k<g.length;k++){c=g[k].nodeName.split(":");1===c.length&&(c[1]=c[0],c[0]="");h=null;for(e=0;e<f.length;e++)if(f[e].prefix===c[0]){h=f[e].namespaceURI;break}null===h&&(h="");if(this.opts["unique-ids"][h]===c[1])return g[k]}return null},aa=function(a,b,k){var e,g,f,h=[];g=a.getElementsByTagName("*");for(a=0;a<g.length;a++)if(f=g.item(a),1==f.nodeType)for(e=0;e<f.attributes.length;e++)if(f.attributes[e].specified&&!0===k(f,f.attributes[e])){if(b)return f;
h.push(f);break}return b?null:h},J=function(a){var b,k,e;switch(a.nodeType){case 1:"undefined"==typeof a.scopeName||document.addEventListener?(b=a.nodeName.split(":"),e=1==b.length?{prefix:"",name:b[0]}:{prefix:b[0],name:b[1]}):e={prefix:"HTML"==a.scopeName?"":a.scopeName,name:a.nodeName};this.opts["case-sensitive"]||(e.prefix=e.prefix.toLowerCase(),e.name=e.name.toLowerCase());b=D.call(this,a);for(k=0;k<b.length;k++)if(b[k].prefix===e.prefix)return e.ns=b[k].namespaceURI,e;if(""===e.prefix)return e.ns=
null,e;throw Error('Internal Error: nodeExpandedName - Failed to expand namespace prefix "'+e.prefix+'" on element: '+a.nodeName);case 2:b=a.nodeName.split(":");if(1==b.length)return{prefix:"",ns:null,name:b[0]};e={prefix:b[0],name:b[1]};this.opts["case-sensitive"]||(e.prefix=e.prefix.toLowerCase(),e.name=e.name.toLowerCase());b=D.call(this,G(a));for(k=0;k<b.length;k++)if(b[k].prefix===e.prefix)return e.ns=b[k].namespaceURI,e;throw Error('Internal Error: nodeExpandedName - Failed to expand namespace prefix "'+
e.prefix+'" on attribute: '+a.nodeName);case 13:return{prefix:null,ns:null,name:this.opts["case-sensitive"]?a.prefix.toLowerCase():a.prefix};case 7:return{prefix:null,ns:null,name:this.opts["case-sensitive"]?a.target.toLowerCase():a.target};default:return!1}},F=function(a){var b,e="";switch(a.nodeType){case 9:case 1:b=p(new A(a,1,1,{},{},{}),{type:"step",args:["descendant",{type:"nodeType",args:["text",[]]}]});b.sortDocumentOrder();for(a=0;a<b.value.length;a++)e+=b.value[a].data;return e;case 2:return a.nodeValue;
case 13:return a.namespaceURI;case 7:case 8:case 3:case 4:return a.data;default:throw Error("Internal Error: nodeStringValue does not support node type: "+a.nodeType);}},R=function(a,b,e){e=Error(e);e.name=b;e.code=a;return e},Z=function(a,b){for(var e=b.length;e--;)if(b[e]===a)return e;return!1},B=function(a,b,e,g){var f,h,l;if(a instanceof s)if(b instanceof s)for(b=b.stringValues(),a=a.stringValues(),f=0;f<a.length;f++)for(h=0;h<b.length;h++){if(l=B(a[f],b[h],e,g),l.toBoolean())return l}else if(b instanceof
t)for(a=a.stringValues(),f=0;f<a.length;f++){if(l=B(new t(a[f].toNumber()),b,e,g),l.toBoolean())return l}else if(b instanceof v)for(a=a.stringValues(),f=0;f<a.length;f++){if(l=B(a[f],b,e,g),l.toBoolean())return l}else return B(new w(a.toBoolean()),b,e,g);else if(b instanceof s)if(a instanceof t)for(b=b.stringValues(),f=0;f<b.length;f++){if(l=B(a,new t(b[f].toNumber()),e,g),l.toBoolean())return l}else if(a instanceof v)for(b=b.stringValues(),f=0;f<b.length;f++){if(l=B(a,b[f],e,g),l.toBoolean())return l}else return B(a,
new w(b.toBoolean()),e,g);else switch(e){case "=":case "!=":return a instanceof w||b instanceof w?new w(g(a.toBoolean(),b.toBoolean())):a instanceof t||b instanceof t?new w(g(a.toNumber(),b.toNumber())):new w(g(a.toString(),b.toString()));default:return new w(g(a.toNumber(),b.toNumber()))}return new w(!1)},ca=function(a){switch(a.nodeType){case 2:case 3:case 4:case 7:case 8:return G(a);case 1:case 9:return a;default:throw Error("Internal Error: getComparableNode - Node type not supported: "+a.nodeType);
}},da=function(a,b){var e,g,f;if(13==a.nodeType&&13==b.nodeType&&a.ownerElement==b.ownerElement){if(a===b)return 0;g=D.call(X,a.ownerElement);for(f=0;f<g.length;f++)if(g[f]===a){e=4;break}else if(g[f]===b){e=2;break}}else 13==a.nodeType&&(a=a.ownerElement),13==b.nodeType&&(b=b.ownerElement),e=r(a,b);return e},r=function(a,b){var e,g,f;if(a.compareDocumentPosition)return a.compareDocumentPosition(b);if(a===b)return 0;e=ca(a);g=ca(b);if(9===e.nodeType)if(9===g.nodeType){if(e!==g)return 1;f=0}else{if(e!==
g.ownerDocument)return 1;f=20}else if(9===g.nodeType){if(g!==e.ownerDocument)return 1;f=10}else{if(e.ownerDocument!==g.ownerDocument)return 1;if(e.contains&&"undefined"!==typeof e.sourceIndex&&g.contains&&"undefined"!==typeof g.sourceIndex)f=(e!=g&&e.contains(g)&&16)+(e!=g&&g.contains(e)&&8)+(0<=e.sourceIndex&&0<=g.sourceIndex?(e.sourceIndex<g.sourceIndex&&4)+(e.sourceIndex>g.sourceIndex&&2):1)+0;else throw Error('Cannot compare elements. Neither "compareDocumentPosition" nor "contains" available.');
}if(a===e&&b===g)return f;if(a===e)return 0===f||16===(f&16)?20:8===(f&8)?2:f;if(b===g)return 0===f||8===(f&8)?10:16===(f&16)?4:f;if(16===(f&16))return 4;if(8===(f&8))return 2;if(0===f){for(g=0;g<e.attributes.length;g++)if(f=e.attributes[g],f.specified){if(f===b)return 2;if(f===a)return 4}throw Error("Internal Error: compareDocumentPosition failed to sort attributes.");}return f;throw Error("Internal Error: compareDocumentPosition failed to sort nodes.");},S=function(a){if(a){if(9!=a.nodeType&&1!=
a.nodeType&&2!=a.nodeType&&3!=a.nodeType&&4!=a.nodeType&&8!=a.nodeType&&7!=a.nodeType&&13!=a.nodeType)throw R(9,"NOT_SUPPORTED_ERR","The supplied node type is not supported. (nodeType: "+a.nodeType+")");if(2==a.nodeType&&!a.specified)throw R(9,"NOT_SUPPORTED_ERR","The supplied node is a non-specified attribute node. Only specified attribute nodes are supported.");}else throw R(9,"NOT_SUPPORTED_ERR","Context node was not supplied.");},ba=function(a,b,e){var g,h;for(g=0;g<U.length;g++)if(h=U[g],h.prefix===
a&&h.nodeValue===b&&h.ownerElement===e)return h;h=new f(a,b,e);U.push(h);return h};z=function(a,b,e){this.value=a;this.type=b;this.supports=e};z.prototype={value:null,type:null,supports:[],toBoolean:function(){throw Error('Unable to convert "'+this.type+'" to "boolean".');},toString:function(){throw Error('Unable to convert "'+this.type+'" to "string".');},toNumber:function(){throw Error('Unable to convert "'+this.type+'" to "number".');},toNodeSet:function(){throw Error('Unable to convert "'+this.type+
'" to "node-set".');},canConvertTo:function(a){return!1!==Z(a,this.supports)}};w=function(a){z.call(this,a,"boolean",["boolean","string","number"])};w.prototype=new z;w.constructor=w;w.prototype.toBoolean=function(){return this.value};w.prototype.toString=function(){return!0===this.value?"true":"false"};w.prototype.toNumber=function(){return this.value?1:0};s=function(a,b){z.call(this,a,"node-set",["boolean","string","number","node-set"]);this.docOrder=b||"unsorted"};s.prototype=new z;s.constructor=
s;s.prototype.toBoolean=function(){return 0<this.value.length?!0:!1};s.prototype.toString=function(){if(1>this.value.length)return"";this.sortDocumentOrder();return F(this.value[0])};s.prototype.toNumber=function(){return(new v(this.toString())).toNumber()};s.prototype.toNodeSet=function(){return this.value};s.prototype.sortDocumentOrder=function(){switch(this.docOrder){case "document-order":break;case "reverse-document-order":this.value.reverse();break;default:this.value.sort(function(a,b){var e=
da(a,b);if(4==(e&4))return-1;if(2==(e&2))return 1;throw Error("NodeSetType.sortDocumentOrder - unexpected compare result: "+e);})}this.docOrder="document-order"};s.prototype.sortReverseDocumentOrder=function(){switch(this.docOrder){case "document-order":this.value.reverse();break;case "reverse-document-order":break;default:this.sortDocumentOrder(),this.value.reverse()}this.docOrder="reverse-document-order"};s.prototype.append=function(a){var b=0,e=0,g;if(!a instanceof s)throw Error("NodeSetType can be passed into NodeSetType.append method");
this.sortDocumentOrder();for(a.sortDocumentOrder();b<this.value.length&&e<a.value.length;)if(g=da(this.value[b],a.value[e]),0==g)e++;else if(4==(g&4))b++;else if(2==(g&2))this.value.splice(b,0,a.value[e]),b++,e++;else throw Error("Internal Error: NodeSetType.append - unable to sort nodes. (result: "+g+")");for(;e<a.value.length;e++)this.value.push(a.value[e]);this.docOrder="document-order"};s.prototype.stringValues=function(){var a,b=[];for(a=0;a<this.value.length;a++)b.push(new v(F(this.value[a])));
return b};v=function(a){z.call(this,a,"string",["boolean","string","number"])};v.prototype=new z;v.constructor=v;v.prototype.toBoolean=function(){return 0<this.value.length?!0:!1};v.prototype.toString=function(){return this.value};v.prototype.toNumber=function(){var a;a=this.value.match(/^[ \t\r\n]*(-?[0-9]+(?:[.][0-9]*)?)[ \t\r\n]*$/);if(null!==a)return parseFloat(a[1]);a=this.value.match(/^[ \t\r\n]*(-?[.][0-9]+)[ \t\r\n]*$/);return null!==a?parseFloat(a[1]):Number.NaN};t=function(a){z.call(this,
a,"number",["boolean","string","number"])};t.prototype=new z;t.constructor=t;t.prototype.toBoolean=function(){return 0===this.value||isNaN(this.value)?!1:!0};t.prototype.toString=function(){return this.value.toString()};t.prototype.toNumber=function(){return this.value};a=function(b,e){var g;this.code=b;switch(this.code){case a.INVALID_EXPRESSION_ERR:this.name="INVALID_EXPRESSION_ERR";break;case a.TYPE_ERR:this.name="TYPE_ERR";break;default:throw g=Error("Unsupported XPathException code: "+this.code),
g.name="XPathExceptionInternalError",g;}this.message=e||""};a.prototype.toString=function(){return'XPathException: "'+this.message+'", code: "'+this.code+'", name: "'+this.name+'"'};a.INVALID_EXPRESSION_ERR=51;a.TYPE_ERR=52;g=function(a){var b,e,g;for(b in a){g=!1;for(e in this.opts)if(b===e){this.opts[b]=a[b];g=!0;break}if(!g)throw Error("Unsupported option: "+b);}this.opts["unique-ids"]["http://www.w3.org/XML/1998/namespace"]="id";this.opts["unique-ids"]["http://www.w3.org/1999/xhtml"]="id"};g.prototype=
{opts:{"unique-ids":{},"case-sensitive":!1},createExpression:function(b,g){var k,f,h={},r;try{k=XPathJS._parser.parse(b)}catch(l){throw k="The expression is not a legal expression.",k=l instanceof XPathJS._parser.SyntaxError?k+(" (line: "+l.line+", character: "+l.column+")"):k+(" ("+l.message+")"),new a(a.INVALID_EXPRESSION_ERR,k);}if(0<k.nsPrefixes.length){if("object"!=typeof g||"undefined"===typeof g.lookupNamespaceURI)throw new a(a.INVALID_EXPRESSION_ERR,"No namespace resolver provided or lookupNamespaceURI function not supported.");
for(f=0;f<k.nsPrefixes.length;f++)if(r=k.nsPrefixes[f],h[r]=g.lookupNamespaceURI(r),null===h[r])throw R(14,"NAMESPACE_ERR",'Undefined namespace prefix "'+r+'" in the context of the given resolver.');}return new e(k,h,this.opts)},createNSResolver:function(a){return new h(a)},evaluate:function(a,b,e,g,f){a=this.createExpression(a,e);return a.evaluate(b,g,f)}};e=function(a,b,e){this.parsedExpression=a;this.namespaceMapping=b;this.opts=e||{}};e.prototype={parsedExpression:null,namespaceMapping:null,opts:{},
evaluate:function(a,e,g){X=this;S(a);a=new A(a,1,1,{},K,this.namespaceMapping,this.opts);return b.factory(a,e,p(a,this.parsedExpression.tree))}};A=function(a,b,e,g,f,h,l){this.node=a;this.pos=b;this.size=e;this.vars=g;this.fns=f;this.nsMap=h;this.opts=l||{}};A.prototype={node:null,pos:null,size:null,vars:null,fns:null,nsMap:null,opts:null,clone:function(a,b,e){return new A(a||this.node,"undefined"!=typeof b?b:this.pos,"undefined"!=typeof e?e:this.size,this.vars,this.fns,this.nsMap,this.opts)}};h=
function(a){S(a);this.node=a};h.prototype={node:null,lookupNamespaceURI:function(a){var b=this.node,e,g;switch(a){case "xml":return"http://www.w3.org/XML/1998/namespace";case "xmlns":return"http://www.w3.org/2000/xmlns/";default:switch(this.node.nodeType){case 9:b=b.documentElement;break;case 1:break;default:b=G(b)}if(null!=b&&1==b.nodeType){if(""==a){if(g=b.getAttribute("xmlns"),null!==g)return g}else{if(b.ownerDocument.documentElement===b&&"object"===typeof b.ownerDocument.namespaces)for(e=0;e<
b.ownerDocument.namespaces.length;e++)if(g=b.ownerDocument.namespaces.item(e),g.name==a)return g.urn;for(e=0;e<b.attributes.length;e++)if(b.attributes[e].specified&&"xmlns:"+a==b.attributes[e].nodeName)return b.attributes[e].nodeValue}if(b.ownerDocument.documentElement!==b&&b.parentNode)return e=this.node,this.node=b.parentNode,g=this.lookupNamespaceURI(a),this.node=e,g}return null}}};C={"/":function(a,b){var e,g,f,h;if(null===a)g=new s([O(this.node)],"document-order");else if(g=p(this,a),!g instanceof
s)throw Error("Left side of path separator (/) must be of node-set type. (type: "+g.type+")");if(null===b)h=g;else for(h=new s([],"document-order"),e=0;e<g.value.length;e++){f=this.clone(g.value[e]);f=p(f,b);if(!f instanceof s)throw Error("Right side of path separator (/) must be of node-set type. (type: "+f.type+")");h.append(f)}return h},step:function(a,b){var e,g,f,h,l;switch(a){case "child":e=new s($(this.node),"document-order");break;case "descendant":e=new s(E(this.node),"document-order");break;
case "parent":e=G(this.node);e=new s(e?[e]:[],"document-order");break;case "ancestor":e=new s(P(this.node),"reverse-document-order");break;case "following-sibling":e=new s(H(this.node,"nextSibling"),"document-order");break;case "preceding-sibling":e=new s(H(this.node,"previousSibling"),"reverse-document-order");break;case "following":e=s;h=this.node;g=[];var c;f=P(h);f.unshift(h);for(h=0;h<f.length;h++)for(l=H(f[h],"nextSibling"),c=0;c<l.length;c++)g.push(l[c]),g.push.apply(g,E(l[c]));e=new e(g,"document-order");
break;case "preceding":e=s;h=this.node;g=[];f=P(h);f.unshift(h);for(h=0;h<f.length;h++)for(l=H(f[h],"previousSibling"),c=0;c<l.length;c++)g.push.apply(g,E(l[c]).reverse()),g.push(l[c]);e=new e(g,"reverse-document-order");break;case "attribute":e=new s(M(this.node),"document-order");break;case "namespace":e=new s(D.call(this,this.node),"document-order");break;case "self":e=new s([this.node],"document-order");break;case "descendant-or-self":e=E(this.node);e.unshift(this.node);e=new s(e,"document-order");
break;case "ancestor-or-self":e=P(this.node);e.unshift(this.node);e=new s(e,"reverse-document-order");break;default:throw Error("Axis type not supported: "+a);}switch(b.type){case "nodeType":if("node"==b.args[0])break;for(g=e.value.length-1;0<=g;g--)switch(b.args[0]){case "text":3!=e.value[g].nodeType&&4!=e.value[g].nodeType&&e.value.splice(g,1);break;case "comment":8!=e.value[g].nodeType&&e.value.splice(g,1);break;case "processing-instruction":(7!=e.value[g].nodeType||0<b.args[1].length&&p(this,
b.args[1][0])!=e.value[g].nodeName)&&e.value.splice(g,1)}break;case "name":f=p(this,b);switch(a){case "attribute":h=2;break;case "namespace":h=13;break;default:h=1}for(g=e.value.length-1;0<=g;g--)if(e.value[g].nodeType!=h)e.value.splice(g,1);else if(null!==f.ns||null!==f.name)l=J.call(this,e.value[g]),!1===l||l.ns!==f.ns?e.value.splice(g,1):null!==f.name&&l.name.toLowerCase()!=f.name.toLowerCase()&&e.value.splice(g,1);break;default:throw Error("NodeTest type not supported in step: "+b.type);}return e},
predicate:function(a,b,e){var g,f,h,l;b=p(this,b);if(!b instanceof s)throw Error('Expected "node-set", got: '+b.type);switch(a){case "ancestor":case "ancestor-or-self":case "preceding":case "preceding-sibling":b.sortReverseDocumentOrder();break;default:b.sortDocumentOrder()}for(f=0;f<e.length;f++)for(a=0,h=1,l=b.value.length;a<b.value.length;h++){g=p(this.clone(b.value[a],h,l),e[f]);if(g instanceof t){if(g.value!=h){b.value.splice(a,1);continue}}else if(!g.toBoolean()){b.value.splice(a,1);continue}a++}return b},
"function":function(a,b){var e,g=[],f=function(a){return(null!==a.ns?"{"+a.ns+"}":"{}")+a.name},h=function(a){var c,b=[],e;for(c=0;c<a.length;c++)e=void 0===a[c].t?"object":a[c].t,!1!==a[c].r?!0===a[c].rep&&(e+="+"):e=!0===a[c].rep?e+"*":e+"?",b.push(e);return"("+b.join(", ")+")"},l,c,m=0,r=[];e=p(this,a);null===e.ns&&(e.ns="");if(!this.fns[e.ns]||!this.fns[e.ns][e.name])throw Error('Function "'+f(e)+'" does not exist.');l=this.fns[e.ns][e.name];l.args||(l.args=[]);for(m=c=0;c<l.args.length;m++,c++){if(void 0===
b[m]){if(!1!==l.args[c].r)throw Error('Function "'+f(e)+'" expects '+h(l.args)+".");}else r.push(void 0===l.args[c].t?"object":l.args[c].t);if(!0===l.args[c].rep){for(;m<b.length;m++)r.push(void 0===l.args[c].t?"object":l.args[c].t);break}}if(r.length<b.length)throw Error('Function "'+f(e)+'" expects '+h(l.args)+".");for(c=0;c<b.length;c++){m=p(this,b[c]);if("object"!==r[c]&&!m.canConvertTo(r[c]))throw Error('Function "'+f(e)+'" expects '+h(l.args)+'.Cannot convert "'+m.type+'" to "'+r[c]+'".');g.push(m)}result=
l.fn.apply(this,g);if(!result instanceof z)throw Error('Function "'+f(e)+'" did not return a value that inherits from BaseType.');if("object"!==l.ret&&!result.canConvertTo(l.ret))throw Error('Function "'+f(e)+'" return "'+result.type+'" type that cannot be converted to "'+l.ret+'".');return result},"|":function(a,b){a=p(this,a);b=p(this,b);if("undefined"==typeof a||"undefined"==typeof b||!a instanceof s||!b instanceof s)throw Error('Unable to perform union on non-"node-set" types.');a.append(b);return a},
or:function(a,b){return p(this,a).toBoolean()?new w(!0):new w(p(this,b).toBoolean())},and:function(a,b){return p(this,a).toBoolean()?new w(p(this,b).toBoolean()):new w(!1)},"=":function(a,b){return B.call(this,p(this,a),p(this,b),"=",function(a,b){return a==b})},"!=":function(a,b){return B.call(this,p(this,a),p(this,b),"!=",function(a,b){return a!=b})},"<=":function(a,b){return B.call(this,p(this,a),p(this,b),"<=",function(a,b){return a<=b})},"<":function(a,b){return B.call(this,p(this,a),p(this,
b),"<",function(a,b){return a<b})},">=":function(a,b){return B.call(this,p(this,a),p(this,b),">=",function(a,b){return a>=b})},">":function(a,b){return B.call(this,p(this,a),p(this,b),">",function(a,b){return a>b})},"+":function(a,b){return new t(p(this,a).toNumber()+p(this,b).toNumber())},"-":function(a,b){return new t(p(this,a).toNumber()-p(this,b).toNumber())},div:function(a,b){return new t(p(this,a).toNumber()/p(this,b).toNumber())},mod:function(a,b){return new t(p(this,a).toNumber()%p(this,b).toNumber())},
"*":function(a,b){return new t(p(this,a).toNumber()*p(this,b).toNumber())},string:function(a){return new v(a)},number:function(a){return new t(a)},$:function(a){throw Error("TODO: Not implemented.16");},name:function(a,b){var e=null;if(null!==a&&(e=this.nsMap[a],!e))throw Error('Namespace prefix "'+a+'" is not mapped to a namespace.');return{ns:e,name:b}}};K={"":{last:{fn:function(){return new t(this.size)},ret:"number"},position:{fn:function(){return new t(this.pos)},ret:"number"},count:{fn:function(a){return new t(a.toNodeSet().length)},
args:[{t:"node-set"}],ret:"number"},id:{fn:function(a){var b=this,e=[],g,f=[],h=function(a){var b=a.split(/[\u0020\u0009\u000D\u000A]+/);for(a=b.length-1;0<=a;a--)0==b[a].length&&b.splice(a,1);return b};if(a instanceof s)for(g=0;g<a.value.length;g++)e.push.apply(e,h(F(a.value[g])));else a=a.toString(),e=h(a);for(g=e.length-1;0<=g;g--)for(a=g-1;0<=a;a--)if(e[g]==e[a]&&g!=a){e.splice(g,1);break}for(g=0;g<e.length;g++)(a=O(this.node).getElementById(e[g]))&&W.call(this,a)?f.push(a):aa(O(this.node),!0,
function(a,c){var h=W.call(b,a,c);if(h&&h.nodeValue==e[g])return f.push(a),!0});return new s(f)},args:[{}],ret:"node-set"},"local-name":{fn:function(a){var b,e="";0==arguments.length&&(a=new s([this.node]));0<a.toNodeSet().length&&(a.sortDocumentOrder(),b=J.call(this,a.value[0]),!1!==b&&(e=b.name));return new v(e)},args:[{t:"node-set",r:!1}],ret:"string"},"namespace-uri":{fn:function(a){var b,e="";0==arguments.length&&(a=new s([this.node]));0<a.toNodeSet().length&&(a.sortDocumentOrder(),b=J.call(this,
a.value[0]),!1!==b&&null!==b.ns&&(e=b.ns));return new v(e)},args:[{t:"node-set",r:!1}],ret:"string"},name:{fn:function(a){var b,e="";0==arguments.length&&(a=new s([this.node]));0<a.toNodeSet().length&&(a.sortDocumentOrder(),b=J.call(this,a.value[0]),!1!==b&&(e=b.prefix&&0<b.prefix.length?b.prefix+":"+b.name:b.name));return new v(e)},args:[{t:"node-set",r:!1}],ret:"string"},string:{fn:function(a){0==arguments.length&&(a=new s([this.node],"document-order"));return new v(a.toString())},args:[{t:"object",
r:!1}],ret:"string"},concat:{fn:function(a,b){var e,g="";for(e=0;e<arguments.length;e++)g+=arguments[e].toString();return new v(g)},args:[{t:"string"},{t:"string"},{t:"string",r:!1,rep:!0}],ret:"string"},"starts-with":{fn:function(a,b){return new w(a.toString().substr(0,(b=b.toString()).length)==b)},args:[{t:"string"},{t:"string"}],ret:"string"},contains:{fn:function(a,b){return new w(-1!=a.toString().indexOf(b.toString()))},args:[{t:"string"},{t:"string"}],ret:"string"},"substring-before":{fn:function(a,
b){a=a.toString();b=a.indexOf(b.toString());return new v(-1==b?"":a.substr(0,b))},args:[{t:"string"},{t:"string"}],ret:"string"},"substring-after":{fn:function(a,b){var e;a=a.toString();b=b.toString();e=a.indexOf(b);return new v(-1==e?"":a.substr(e+b.length))},args:[{t:"string"},{t:"string"}],ret:"string"},substring:{fn:function(a,b,e){a=a.toString();b=Math.round(b.toNumber())-1;return new v(isNaN(b)?"":2==arguments.length?a.substring(0>b?0:b):a.substring(0>b?0:b,b+Math.round(e.toNumber())))},args:[{t:"string"},
{t:"number"},{t:"number",r:!1}],ret:"string"},"string-length":{fn:function(a){a=0==arguments.length?F(this.node):a.toString();return new t(a.length)},args:[{t:"string",r:!1}],ret:"number"},"normalize-space":{fn:function(a){a=0==arguments.length?F(this.node):a.toString();return new v(a.replace(/^[\u0020\u0009\u000D\u000A]+/,"").replace(/[\u0020\u0009\u000D\u000A]+$/,"").replace(/[\u0020\u0009\u000D\u000A]+/g," "))},args:[{t:"string",r:!1}],ret:"string"},translate:{fn:function(a,b,e){var g="",f,h,l;
a=a.toString();b=b.toString();e=e.toString();for(f=0;f<a.length;f++)if(-1==(h=b.indexOf(l=a.charAt(f)))||(l=e.charAt(h)))g+=l;return new v(g)},args:[{t:"string"},{t:"string"},{t:"string"}],ret:"string"},"boolean":{fn:function(a){return new w(a.toBoolean())},args:[{r:!0}],ret:"boolean"},not:{fn:function(a){return new w(!a.toBoolean())},args:[{t:"boolean"}],ret:"boolean"},"true":{fn:function(){return new w(!0)},ret:"boolean"},"false":{fn:function(){return new w(!1)},ret:"boolean"},lang:{fn:function(a){for(var b=
this.node,e,g,f=a.toString().toLowerCase().split("-"),h,l,c;9!=b.nodeType;b=G(b))for(a=M(b),h=0;h<a.length;h++)if(e=a[h].nodeName.split(":"),1===e.length&&(e[1]=e[0],e[0]=""),"lang"==e[1]&&(g=a[h].nodeValue.toLowerCase().split("-"),!(g.length<f.length))){c=!0;for(l=0;l<f.length;l++)if(f[l]!=g[l]){c=!1;break}if(c)for(g=D.call(this,b),l=0;l<g.length;l++)if(g[l].prefix==e[0]&&"http://www.w3.org/XML/1998/namespace"==g[l].nodeValue)return new w(!0)}return new w(!1)},args:[{t:"string"}],ret:"boolean"},
number:{fn:function(a){0==arguments.length&&(a=new s([this.node],"document-order"));return new t(a.toNumber())},args:[{t:"object",r:!1}],ret:"number"},sum:{fn:function(a){var b,e=0;a=a.toNodeSet();for(b=0;b<a.length;b++)e+=(new v(F(a[b]))).toNumber();return new t(e)},args:[{t:"node-set"}],ret:"number"},floor:{fn:function(a){return new t(Math.floor(a))},args:[{t:"number"}],ret:"number"},ceiling:{fn:function(a){return new t(Math.ceil(a))},args:[{t:"number"}],ret:"number"},round:{fn:function(a){return new t(Math.round(a))},
args:[{t:"number"}],ret:"number"}}};p=function(a,b){if("function"!=typeof C[b.type])throw Error("Internal Error: Expression type does not exist: "+b.type);return C[b.type].apply(a,b.args)};b=function(e,g,f){switch(g){case b.NUMBER_TYPE:this.resultType=b.NUMBER_TYPE;this.numberValue=f.toNumber();break;case b.STRING_TYPE:this.resultType=b.STRING_TYPE;this.stringValue=f.toString();break;case b.BOOLEAN_TYPE:this.resultType=b.BOOLEAN_TYPE;this.booleanValue=f.toBoolean();break;case b.UNORDERED_NODE_ITERATOR_TYPE:case b.ORDERED_NODE_ITERATOR_TYPE:case b.UNORDERED_NODE_SNAPSHOT_TYPE:case b.ORDERED_NODE_SNAPSHOT_TYPE:case b.ANY_UNORDERED_NODE_TYPE:case b.FIRST_ORDERED_NODE_TYPE:if(!f instanceof
s)throw Error('Expected result of type "node-set", got: "'+f.type+'"');this.resultType=g;switch(g){case b.UNORDERED_NODE_ITERATOR_TYPE:case b.UNORDERED_NODE_SNAPSHOT_TYPE:this._value=f.toNodeSet();this.snapshotLength=this._value.length;break;case b.ORDERED_NODE_ITERATOR_TYPE:case b.ORDERED_NODE_SNAPSHOT_TYPE:f.sortDocumentOrder();this._value=f.toNodeSet();this.snapshotLength=this._value.length;break;case b.ANY_UNORDERED_NODE_TYPE:f=f.toNodeSet();this.singleNodeValue=f.length?f[0]:null;break;case b.FIRST_ORDERED_NODE_TYPE:f.sortDocumentOrder();
f=f.toNodeSet();this.singleNodeValue=f.length?f[0]:null;break;default:throw new a(a.TYPE_ERR,"XPath result type not supported. (type: "+g+")");}break;default:throw new a(a.TYPE_ERR,"XPath result type not supported. (type: "+g+")");}};b.factory=function(e,g,f){if(g!==b.ANY_TYPE)return new b(e,g,f);if(f instanceof s)e=new b(e,b.UNORDERED_NODE_ITERATOR_TYPE,f);else if(f instanceof t)e=new b(e,b.NUMBER_TYPE,f);else if(f instanceof w)e=new b(e,b.BOOLEAN_TYPE,f);else if(f instanceof v)e=new b(e,b.STRING_TYPE,
f);else throw new a(a.TYPE_ERR,"Internal Error: Unsupported value type: "+typeof f);return e};b.prototype={resultType:null,numberValue:null,stringValue:null,booleanValue:null,singleNodeValue:null,invalidIteratorState:null,snapshotLength:null,_iteratorIndex:0,iterateNext:function(){if(this.resultType!=b.UNORDERED_NODE_ITERATOR_TYPE&&this.resultType!=b.ORDERED_NODE_ITERATOR_TYPE)throw new a(a.TYPE_ERR,"iterateNext() method may only be used with results of type UNORDERED_NODE_ITERATOR_TYPE or ORDERED_NODE_ITERATOR_TYPE");
return this._iteratorIndex<this._value.length?this._value[this._iteratorIndex++]:null},snapshotItem:function(e){if(this.resultType!=b.UNORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!=b.ORDERED_NODE_SNAPSHOT_TYPE)throw new a(a.TYPE_ERR,"snapshotItem() method may only be used with results of type UNORDERED_NODE_SNAPSHOT_TYPE or ORDERED_NODE_SNAPSHOT_TYPE");return this._value[e]}};b.ANY_TYPE=0;b.NUMBER_TYPE=1;b.STRING_TYPE=2;b.BOOLEAN_TYPE=3;b.UNORDERED_NODE_ITERATOR_TYPE=4;b.ORDERED_NODE_ITERATOR_TYPE=
5;b.UNORDERED_NODE_SNAPSHOT_TYPE=6;b.ORDERED_NODE_SNAPSHOT_TYPE=7;b.ANY_UNORDERED_NODE_TYPE=8;b.FIRST_ORDERED_NODE_TYPE=9;f=function(a,b,e){if(1!=e.nodeType)throw Error("Internal Error: XPathNamespace owner element must be an Element node.");this.ownerElement=e;this.ownerDocument=e.ownerDocument;this.nodeName="#namespace";this.localName=this.prefix=a;this.nodeType=f.XPATH_NAMESPACE_NODE;this.nodeValue=this.namespaceURI=b};f.XPATH_NAMESPACE_NODE=13;return q={XPathException:a,XPathEvaluator:g,XPathNSResolver:h,
XPathExpression:e,XPathResult:b,XPathNamespace:f,getCurrentDomLevel3XPathBindings:function(){return{window:{XPathException:window.XPathException,XPathExpression:window.XPathExpression,XPathNSResolver:window.XPathNSResolver,XPathResult:window.XPathResult,XPathNamespace:window.XPathNamespace},document:{createExpression:document.createExpression,createNSResolver:document.createNSResolver,evaluate:document.evaluate}}},createDomLevel3XPathBindings:function(r){var p=new g(r);return{window:{XPathException:a,
XPathExpression:e,XPathNSResolver:h,XPathResult:b,XPathNamespace:f},document:{createExpression:function(){return p.createExpression.apply(p,arguments)},createNSResolver:function(){return p.createNSResolver.apply(p,arguments)},evaluate:function(){return p.evaluate.apply(p,arguments)}}}},bindDomLevel3XPath:function(a){a=a||q.createDomLevel3XPathBindings();var b=q.getCurrentDomLevel3XPathBindings(),e;for(e in a.window)window[e]=a.window[e];for(e in a.document)document[e]=a.document[e];return b}}}();
XPathJS._parser=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var g={parse:function(e,g){function b(a){c<ea||(c>ea&&(ea=c,ha=[]),ha.push(a))}function f(){var a;a=p();null===a&&(a=q());return a}function q(){var a,g,f,y,h,x;a=w();null===a&&(h=y=c,47===e.charCodeAt(c)?(a="/",c++):(a=null,0===m&&b('"/"')),
null!==a?(x=c,g=r(),null!==g?(f=p(),null!==f?g=[g,f]:(g=null,c=x)):(g=null,c=x),g=null!==g?g:"",null!==g?a=[a,g]:(a=null,c=h)):(a=null,c=h),null!==a&&(a=a[1],a={type:"/",args:[null,a?a[1]:null]}),null===a&&(c=y));return a}function p(){var a,g,f,y,h,x,la,k,n;k=la=c;a=C();if(null!==a){g=[];n=c;f=r();null!==f?("//"===e.substr(c,2)?(y="//",c+=2):(y=null,0===m&&b('"//"')),null===y&&(47===e.charCodeAt(c)?(y="/",c++):(y=null,0===m&&b('"/"'))),null!==y?(h=r(),null!==h?(x=C(),null!==x?f=[f,y,h,x]:(f=null,
c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?("//"===e.substr(c,2)?(y="//",c+=2):(y=null,0===m&&b('"//"')),null===y&&(47===e.charCodeAt(c)?(y="/",c++):(y=null,0===m&&b('"/"'))),null!==y?(h=r(),null!==h?(x=C(),null!==x?f=[f,y,h,x]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=k)}else a=null,c=k;if(null!==a){g=a[0];a=a[1];for(f=0;f<a.length;f++)g=ia(a[f][1],g,a[f][3]);a=g}null===a&&(c=la);return a}function C(){var a,b,
e,g,f,h,m,k,n;k=m=c;a=K();if(null!==a)if(b=r(),null!==b)if(e=U(),null!==e){g=[];n=c;f=r();null!==f?(h=z(),null!==h?f=[f,h]:(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?(h=z(),null!==h?f=[f,h]:(f=null,c=n)):(f=null,c=n);null!==g?a=[a,b,e,g]:(a=null,c=k)}else a=null,c=k;else a=null,c=k;else a=null,c=k;null!==a&&(b=a[0],a=ka({type:"step",args:[b,a[2]]},b,a[3],1));null===a&&(c=m);null===a&&(a=v());return a}function K(){var a,g,f,y,h;h=y=c;a=A();null!==a?(g=r(),null!==g?("::"===
e.substr(c,2)?(f="::",c+=2):(f=null,0===m&&b('"::"')),null!==f?a=[a,g,f]:(a=null,c=h)):(a=null,c=h)):(a=null,c=h);null!==a&&(a=a[0]);null===a&&(c=y);null===a&&(y=c,a=t(),null!==a&&(a=a.length?a:"child"),null===a&&(c=y));return a}function A(){var a;"ancestor-or-self"===e.substr(c,16)?(a="ancestor-or-self",c+=16):(a=null,0===m&&b('"ancestor-or-self"'));null===a&&("ancestor"===e.substr(c,8)?(a="ancestor",c+=8):(a=null,0===m&&b('"ancestor"')),null===a&&("attribute"===e.substr(c,9)?(a="attribute",c+=9):
(a=null,0===m&&b('"attribute"')),null===a&&("child"===e.substr(c,5)?(a="child",c+=5):(a=null,0===m&&b('"child"')),null===a&&("descendant-or-self"===e.substr(c,18)?(a="descendant-or-self",c+=18):(a=null,0===m&&b('"descendant-or-self"')),null===a&&("descendant"===e.substr(c,10)?(a="descendant",c+=10):(a=null,0===m&&b('"descendant"')),null===a&&("following-sibling"===e.substr(c,17)?(a="following-sibling",c+=17):(a=null,0===m&&b('"following-sibling"')),null===a&&("following"===e.substr(c,9)?(a="following",
c+=9):(a=null,0===m&&b('"following"')),null===a&&("namespace"===e.substr(c,9)?(a="namespace",c+=9):(a=null,0===m&&b('"namespace"')),null===a&&("parent"===e.substr(c,6)?(a="parent",c+=6):(a=null,0===m&&b('"parent"')),null===a&&("preceding-sibling"===e.substr(c,17)?(a="preceding-sibling",c+=17):(a=null,0===m&&b('"preceding-sibling"')),null===a&&("preceding"===e.substr(c,9)?(a="preceding",c+=9):(a=null,0===m&&b('"preceding"')),null===a&&("self"===e.substr(c,4)?(a="self",c+=4):(a=null,0===m&&b('"self"'))))))))))))));
return a}function U(){var a,g,f,h,u,x,k,l,n;n=l=c;a=ca();null!==a?(g=r(),null!==g?(40===e.charCodeAt(c)?(f="(",c++):(f=null,0===m&&b('"("')),null!==f?(h=r(),null!==h?(41===e.charCodeAt(c)?(u=")",c++):(u=null,0===m&&b('")"')),null!==u?a=[a,g,f,h,u]:(a=null,c=n)):(a=null,c=n)):(a=null,c=n)):(a=null,c=n)):(a=null,c=n);null!==a&&(a={type:"nodeType",args:[a[0],[]]});null===a&&(c=l);null===a&&(n=l=c,"processing-instruction"===e.substr(c,22)?(a="processing-instruction",c+=22):(a=null,0===m&&b('"processing-instruction"')),
null!==a?(g=r(),null!==g?(40===e.charCodeAt(c)?(f="(",c++):(f=null,0===m&&b('"("')),null!==f?(h=r(),null!==h?(u=W(),null!==u?(x=r(),null!==x?(41===e.charCodeAt(c)?(k=")",c++):(k=null,0===m&&b('")"')),null!==k?a=[a,g,f,h,u,x,k]:(a=null,c=n)):(a=null,c=n)):(a=null,c=n)):(a=null,c=n)):(a=null,c=n)):(a=null,c=n)):(a=null,c=n),null!==a&&(a={type:"nodeType",args:[a[0],[a[4]]]}),null===a&&(c=l),null===a&&(l=c,a=B(),null===a&&(c=l)));return a}function z(){var a,g,f,h,u,x,k;k=x=c;91===e.charCodeAt(c)?(a="[",
c++):(a=null,0===m&&b('"["'));null!==a?(g=r(),null!==g?(f=s(),null!==f?(h=r(),null!==h?(93===e.charCodeAt(c)?(u="]",c++):(u=null,0===m&&b('"]"')),null!==u?a=[a,g,f,h,u]:(a=null,c=k)):(a=null,c=k)):(a=null,c=k)):(a=null,c=k)):(a=null,c=k);null!==a&&(a=a[2]);null===a&&(c=x);return a}function w(){var a,g,f,h,u;u=h=c;"//"===e.substr(c,2)?(a="//",c+=2):(a=null,0===m&&b('"//"'));null!==a?(g=r(),null!==g?(f=p(),null!==f?a=[a,g,f]:(a=null,c=u)):(a=null,c=u)):(a=null,c=u);null!==a&&(a=ia("//",null,a[2]));
null===a&&(c=h);return a}function v(){var a,g;g=c;".."===e.substr(c,2)?(a="..",c+=2):(a=null,0===m&&b('".."'));null===a&&(46===e.charCodeAt(c)?(a=".",c++):(a=null,0===m&&b('"."')));if(null!==a){var f={type:"step",args:["self",{type:"nodeType",args:["node",[]]}]};".."==a&&(f.args[0]="parent");a=f}null===a&&(c=g);return a}function t(){var a,g;g=c;64===e.charCodeAt(c)?(a="@",c++):(a=null,0===m&&b('"@"'));a=null!==a?a:"";null!==a&&(a=a?"attribute":"");null===a&&(c=g);return a}function s(){var a,b;b=c;
a=P();null===a&&(c=b);return a}function X(){var a,g,f,h,u,x,k;x=c;a=Z();null===a&&(c=x);null===a&&(k=x=c,40===e.charCodeAt(c)?(a="(",c++):(a=null,0===m&&b('"("')),null!==a?(g=r(),null!==g?(f=s(),null!==f?(h=r(),null!==h?(41===e.charCodeAt(c)?(u=")",c++):(u=null,0===m&&b('")"')),null!==u?a=[a,g,f,h,u]:(a=null,c=k)):(a=null,c=k)):(a=null,c=k)):(a=null,c=k)):(a=null,c=k),null!==a&&(a=a[2]),null===a&&(c=x),null===a&&(x=c,a=W(),null===a&&(c=x),null===a&&(x=c,a=aa(),null===a&&(c=x),null===a&&(a=O()))));
return a}function O(){var a,g,f,h,u,x,k,l,n,p,q,t,w,v;t=q=c;a=R();if(null!==a)if(g=r(),null!==g)if(40===e.charCodeAt(c)?(f="(",c++):(f=null,0===m&&b('"("')),null!==f){w=c;h=r();if(null!==h)if(u=s(),null!==u){x=[];v=c;k=r();null!==k?(44===e.charCodeAt(c)?(l=",",c++):(l=null,0===m&&b('","')),null!==l?(n=r(),null!==n?(p=s(),null!==p?k=[k,l,n,p]:(k=null,c=v)):(k=null,c=v)):(k=null,c=v)):(k=null,c=v);for(;null!==k;)x.push(k),v=c,k=r(),null!==k?(44===e.charCodeAt(c)?(l=",",c++):(l=null,0===m&&b('","')),
null!==l?(n=r(),null!==n?(p=s(),null!==p?k=[k,l,n,p]:(k=null,c=v)):(k=null,c=v)):(k=null,c=v)):(k=null,c=v);null!==x?h=[h,u,x]:(h=null,c=w)}else h=null,c=w;else h=null,c=w;h=null!==h?h:"";null!==h?(u=r(),null!==u?(41===e.charCodeAt(c)?(x=")",c++):(x=null,0===m&&b('")"')),null!==x?a=[a,g,f,h,u,x]:(a=null,c=t)):(a=null,c=t)):(a=null,c=t)}else a=null,c=t;else a=null,c=t;else a=null,c=t;if(null!==a){g=a[0];a=a[3];h=[];if(a)for(h.push(a[1]),f=0;f<a[2].length;f++)h.push(a[2][f][3]);a={type:"function",args:[g,
h]}}null===a&&(c=q);return a}function $(){var a,g,f,h,u,k,l,p,n;p=l=c;a=E();if(null!==a){g=[];n=c;f=r();null!==f?(124===e.charCodeAt(c)?(h="|",c++):(h=null,0===m&&b('"|"')),null!==h?(u=r(),null!==u?(k=E(),null!==k?f=[f,h,u,k]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?(124===e.charCodeAt(c)?(h="|",c++):(h=null,0===m&&b('"|"')),null!==h?(u=r(),null!==u?(k=E(),null!==k?f=[f,h,u,k]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?
a=[a,g]:(a=null,c=p)}else a=null,c=p;null!==a&&(a=T(a[0],a[1],1,3));null===a&&(c=l);return a}function E(){var a,g,h,y,u,k,l,q;l=k=c;a=G();null!==a?(q=c,g=r(),null!==g?("//"===e.substr(c,2)?(h="//",c+=2):(h=null,0===m&&b('"//"')),null===h&&(47===e.charCodeAt(c)?(h="/",c++):(h=null,0===m&&b('"/"'))),null!==h?(y=r(),null!==y?(u=p(),null!==u?g=[g,h,y,u]:(g=null,c=q)):(g=null,c=q)):(g=null,c=q)):(g=null,c=q),g=null!==g?g:"",null!==g?a=[a,g]:(a=null,c=l)):(a=null,c=l);null!==a&&(g=a[0],a=(a=a[1])?ia(a[1],
g,a[3]):g);null===a&&(c=k);null===a&&(k=c,a=f(),null===a&&(c=k));return a}function G(){var a,b,e,g,f,h,k;h=f=c;a=X();if(null!==a){b=[];k=c;e=r();null!==e?(g=z(),null!==g?e=[e,g]:(e=null,c=k)):(e=null,c=k);for(;null!==e;)b.push(e),k=c,e=r(),null!==e?(g=z(),null!==g?e=[e,g]:(e=null,c=k)):(e=null,c=k);null!==b?a=[a,b]:(a=null,c=h)}else a=null,c=h;null!==a&&(a=ka(a[0],"child",a[1],1));null===a&&(c=f);return a}function P(){var a,g,f,h,k,l,p,q,n;q=p=c;a=H();if(null!==a){g=[];n=c;f=r();null!==f?("or"===
e.substr(c,2)?(h="or",c+=2):(h=null,0===m&&b('"or"')),null!==h?(k=r(),null!==k?(l=H(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?("or"===e.substr(c,2)?(h="or",c+=2):(h=null,0===m&&b('"or"')),null!==h?(k=r(),null!==k?(l=H(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=q)}else a=null,c=q;null!==a&&(a=T(a[0],a[1],1,3));null===a&&(c=p);return a}function H(){var a,g,f,
h,k,l,p,q,n;q=p=c;a=Q();if(null!==a){g=[];n=c;f=r();null!==f?("and"===e.substr(c,3)?(h="and",c+=3):(h=null,0===m&&b('"and"')),null!==h?(k=r(),null!==k?(l=Q(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?("and"===e.substr(c,3)?(h="and",c+=3):(h=null,0===m&&b('"and"')),null!==h?(k=r(),null!==k?(l=Q(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=q)}else a=null,c=q;null!==
a&&(a=T(a[0],a[1],1,3));null===a&&(c=p);return a}function Q(){var a,g,f,h,k,l,p,q,n;q=p=c;a=M();if(null!==a){g=[];n=c;f=r();null!==f?(61===e.charCodeAt(c)?(h="=",c++):(h=null,0===m&&b('"="')),null===h&&("!="===e.substr(c,2)?(h="!=",c+=2):(h=null,0===m&&b('"!="'))),null!==h?(k=r(),null!==k?(l=M(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?(61===e.charCodeAt(c)?(h="=",c++):(h=null,0===m&&b('"="')),null===h&&("!="===e.substr(c,
2)?(h="!=",c+=2):(h=null,0===m&&b('"!="'))),null!==h?(k=r(),null!==k?(l=M(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=q)}else a=null,c=q;null!==a&&(a=T(a[0],a[1],1,3));null===a&&(c=p);return a}function M(){var a,g,f,h,k,l,p,q,n;q=p=c;a=D();if(null!==a){g=[];n=c;f=r();null!==f?("<="===e.substr(c,2)?(h="<=",c+=2):(h=null,0===m&&b('"<="')),null===h&&(60===e.charCodeAt(c)?(h="<",c++):(h=null,0===m&&b('"<"')),null===h&&(">="===e.substr(c,2)?
(h=">=",c+=2):(h=null,0===m&&b('">="')),null===h&&(62===e.charCodeAt(c)?(h=">",c++):(h=null,0===m&&b('">"'))))),null!==h?(k=r(),null!==k?(l=D(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?("<="===e.substr(c,2)?(h="<=",c+=2):(h=null,0===m&&b('"<="')),null===h&&(60===e.charCodeAt(c)?(h="<",c++):(h=null,0===m&&b('"<"')),null===h&&(">="===e.substr(c,2)?(h=">=",c+=2):(h=null,0===m&&b('">="')),null===h&&(62===e.charCodeAt(c)?(h=
">",c++):(h=null,0===m&&b('">"'))))),null!==h?(k=r(),null!==k?(l=D(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=q)}else a=null,c=q;null!==a&&(a=T(a[0],a[1],1,3));null===a&&(c=p);return a}function D(){var a,g,f,h,k,l,p,q,n;q=p=c;a=I();if(null!==a){g=[];n=c;f=r();null!==f?(43===e.charCodeAt(c)?(h="+",c++):(h=null,0===m&&b('"+"')),null===h&&(45===e.charCodeAt(c)?(h="-",c++):(h=null,0===m&&b('"-"'))),null!==h?(k=r(),null!==k?(l=I(),null!==l?
f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?(43===e.charCodeAt(c)?(h="+",c++):(h=null,0===m&&b('"+"')),null===h&&(45===e.charCodeAt(c)?(h="-",c++):(h=null,0===m&&b('"-"'))),null!==h?(k=r(),null!==k?(l=I(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=q)}else a=null,c=q;null!==a&&(a=T(a[0],a[1],1,3));null===a&&(c=p);return a}function I(){var a,g,f,h,k,l,p,q,n;q=p=c;a=L();if(null!==
a){g=[];n=c;f=r();null!==f?(h=F(),null===h&&("div"===e.substr(c,3)?(h="div",c+=3):(h=null,0===m&&b('"div"')),null===h&&("mod"===e.substr(c,3)?(h="mod",c+=3):(h=null,0===m&&b('"mod"')))),null!==h?(k=r(),null!==k?(l=L(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);for(;null!==f;)g.push(f),n=c,f=r(),null!==f?(h=F(),null===h&&("div"===e.substr(c,3)?(h="div",c+=3):(h=null,0===m&&b('"div"')),null===h&&("mod"===e.substr(c,3)?(h="mod",c+=3):(h=null,0===m&&b('"mod"')))),null!==
h?(k=r(),null!==k?(l=L(),null!==l?f=[f,h,k,l]:(f=null,c=n)):(f=null,c=n)):(f=null,c=n)):(f=null,c=n);null!==g?a=[a,g]:(a=null,c=q)}else a=null,c=q;null!==a&&(a=T(a[0],a[1],1,3));null===a&&(c=p);return a}function L(){var a,g,f,h,k;h=c;a=$();null===a&&(c=h);null===a&&(k=h=c,45===e.charCodeAt(c)?(a="-",c++):(a=null,0===m&&b('"-"')),null!==a?(g=r(),null!==g?(f=L(),null!==f?a=[a,g,f]:(a=null,c=k)):(a=null,c=k)):(a=null,c=k),null!==a&&(a={type:"*",args:[{type:"number",args:[-1]},a[2]]}),null===a&&(c=h));
return a}function W(){var a,g,f,h,k;k=h=c;34===e.charCodeAt(c)?(a='"',c++):(a=null,0===m&&b('"\\""'));if(null!==a){g=[];/^[^"]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b('[^"]'));for(;null!==f;)g.push(f),/^[^"]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b('[^"]'));null!==g?(34===e.charCodeAt(c)?(f='"',c++):(f=null,0===m&&b('"\\""')),null!==f?a=[a,g,f]:(a=null,c=k)):(a=null,c=k)}else a=null,c=k;null!==a&&(a={type:"string",args:[a[1].join("")]});null===a&&(c=h);if(null===a){k=
h=c;39===e.charCodeAt(c)?(a="'",c++):(a=null,0===m&&b('"\'"'));if(null!==a){g=[];/^[^']/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b("[^']"));for(;null!==f;)g.push(f),/^[^']/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b("[^']"));null!==g?(39===e.charCodeAt(c)?(f="'",c++):(f=null,0===m&&b('"\'"')),null!==f?a=[a,g,f]:(a=null,c=k)):(a=null,c=k)}else a=null,c=k;null!==a&&(a={type:"string",args:[a[1].join("")]});null===a&&(c=h)}return a}function aa(){var a,f,g,h,k,l;k=h=c;a=J();null!==
a?(l=c,46===e.charCodeAt(c)?(f=".",c++):(f=null,0===m&&b('"."')),null!==f?(g=J(),g=null!==g?g:"",null!==g?f=[f,g]:(f=null,c=l)):(f=null,c=l),f=null!==f?f:"",null!==f?a=[a,f]:(a=null,c=k)):(a=null,c=k);null!==a&&(f=a[0],a=a[1],a={type:"number",args:[a?parseFloat(f+"."+a[1]):parseInt(f)]});null===a&&(c=h);null===a&&(k=h=c,46===e.charCodeAt(c)?(a=".",c++):(a=null,0===m&&b('"."')),null!==a?(f=J(),null!==f?a=[a,f]:(a=null,c=k)):(a=null,c=k),null!==a&&(a={type:"number",args:[parseFloat("."+a[1])]}),null===
a&&(c=h));return a}function J(){var a,f,g;g=c;/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b("[0-9]"));if(null!==f)for(a=[];null!==f;)a.push(f),/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b("[0-9]"));else a=null;null!==a&&(a=a.join(""));null===a&&(c=g);return a}function F(){var a;42===e.charCodeAt(c)?(a="*",c++):(a=null,0===m&&b('"*"'));return a}function R(){var a,b,e,f;f=e=c;a=S();null!==a?(b=function(a,b){var c;if(null===ja.args[0])for(c=0;c<ma.length;c++)if(ja.args[1]==
ma[c])return!1;return!0}(c,a)?"":null,null!==b?a=[a,b]:(a=null,c=f)):(a=null,c=f);null!==a&&(a=function(a,b){""===b.args[0]?b={type:b.type,args:[null,b.args[1]]}:ga(b.args[0]);return b}(e,a[0]));null===a&&(c=e);return a}function Z(){var a,f,g,h;h=g=c;36===e.charCodeAt(c)?(a="$",c++):(a=null,0===m&&b('"$"'));null!==a?(f=S(),null!==f?a=[a,f]:(a=null,c=h)):(a=null,c=h);null!==a&&(a=a[1],ga(a.args[0]),a={type:"$",args:[a]});null===a&&(c=g);return a}function B(){var a,f,g,h,k;h=c;42===e.charCodeAt(c)?
(a="*",c++):(a=null,0===m&&b('"*"'));null!==a&&(a={type:"name",args:[null,null]});null===a&&(c=h);null===a&&(k=h=c,a=V(),null!==a?(58===e.charCodeAt(c)?(f=":",c++):(f=null,0===m&&b('":"')),null!==f?(42===e.charCodeAt(c)?(g="*",c++):(g=null,0===m&&b('"*"')),null!==g?a=[a,f,g]:(a=null,c=k)):(a=null,c=k)):(a=null,c=k),null!==a&&(a=function(a,b){ga(b);return{type:"name",args:[b,null]}}(h,a[0])),null===a&&(c=h),null===a&&(h=c,a=S(),null!==a&&(a=function(a,b){ga(b.args[0]);return b}(h,a)),null===a&&(c=
h)));return a}function ca(){var a;"comment"===e.substr(c,7)?(a="comment",c+=7):(a=null,0===m&&b('"comment"'));null===a&&("text"===e.substr(c,4)?(a="text",c+=4):(a=null,0===m&&b('"text"')),null===a&&("processing-instruction"===e.substr(c,22)?(a="processing-instruction",c+=22):(a=null,0===m&&b('"processing-instruction"')),null===a&&("node"===e.substr(c,4)?(a="node",c+=4):(a=null,0===m&&b('"node"')))));return a}function da(){var a,f;/^[ \t\r\n]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b("[ \\t\\r\\n]"));
if(null!==f)for(a=[];null!==f;)a.push(f),/^[ \t\r\n]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,0===m&&b("[ \\t\\r\\n]"));else a=null;return a}function r(){var a;a=da();return null!==a?a:""}function S(){var a,b;b=c;a=ba();null===a&&(a=N());null!==a&&(ja=a);null===a&&(c=b);return a}function ba(){var a,f,g,h,k;k=h=c;a=V();null!==a?(58===e.charCodeAt(c)?(f=":",c++):(f=null,0===m&&b('":"')),null!==f?(g=V(),null!==g?a=[a,f,g]:(a=null,c=k)):(a=null,c=k)):(a=null,c=k);null!==a&&(a={type:"name",args:[a[0],
a[2]]});null===a&&(c=h);return a}function N(){var a,b;b=c;a=V();null!==a&&(a={type:"name",args:[null,a]});null===a&&(c=b);return a}function Y(){var a;/^[A-Z]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[A-Z]"));null===a&&(95===e.charCodeAt(c)?(a="_",c++):(a=null,0===m&&b('"_"')),null===a&&(/^[a-z]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[a-z]")),null===a&&(/^[\xC0-\xD6]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\xC0-\\xD6]")),null===a&&(/^[\xD8-\xF6]/.test(e.charAt(c))?
(a=e.charAt(c),c++):(a=null,0===m&&b("[\\xD8-\\xF6]")),null===a&&(/^[\xF8-\u02FF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\xF8-\\u02FF]")),null===a&&(/^[\u0370-\u037D]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u0370-\\u037D]")),null===a&&(/^[\u037F-\u1FFF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u037F-\\u1FFF]")),null===a&&(/^[\u200C-\u200D]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u200C-\\u200D]")),null===a&&(/^[\u2070-\u218F]/.test(e.charAt(c))?
(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u2070-\\u218F]")),null===a&&(/^[\u2C00-\u2FEF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u2C00-\\u2FEF]")),null===a&&(/^[\u3001-\uD7FF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u3001-\\uD7FF]")),null===a&&(/^[\uF900-\uFDCF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\uF900-\\uFDCF]")),null===a&&(/^[\uFDF0-\uFFFD]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\uFDF0-\\uFFFD]")))))))))))))));return a}
function k(){var a;a=Y();null===a&&(45===e.charCodeAt(c)?(a="-",c++):(a=null,0===m&&b('"-"')),null===a&&(46===e.charCodeAt(c)?(a=".",c++):(a=null,0===m&&b('"."')),null===a&&(/^[0-9]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[0-9]")),null===a&&(/^[\xB7]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\xB7]")),null===a&&(/^[\u0300-\u036F]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,0===m&&b("[\\u0300-\\u036F]")),null===a&&(/^[\u203F-\u2040]/.test(e.charAt(c))?(a=e.charAt(c),
c++):(a=null,0===m&&b("[\\u203F-\\u2040]"))))))));return a}function V(){var a,b,e,f,g;g=f=c;a=Y();if(null!==a){b=[];for(e=k();null!==e;)b.push(e),e=k();null!==b?a=[a,b]:(a=null,c=g)}else a=null,c=g;null!==a&&(a=a[0]+a[1].join(""));null===a&&(c=f);return a}function oa(a){a.sort();for(var b=null,c=[],e=0;e<a.length;e++)a[e]!==b&&(c.push(a[e]),b=a[e]);return c}function pa(){for(var a=1,b=1,f=!1,g=0;g<Math.max(c,ea);g++){var h=e.charAt(g);"\n"===h?(f||a++,b=1,f=!1):"\r"===h||"\u2028"===h||"\u2029"===
h?(a++,b=1,f=!0):(b++,f=!1)}return{line:a,column:b}}var l={XPath:function(){var a,b,e,f,g;g=f=c;a=r();null!==a?(b=s(),null!==b?(e=r(),null!==e?a=[a,b,e]:(a=null,c=g)):(a=null,c=g)):(a=null,c=g);null!==a&&(a={tree:a[1],nsPrefixes:fa});null===a&&(c=f);return a},LocationPath:f,AbsoluteLocationPath:q,RelativeLocationPath:p,Step:C,AxisSpecifier:K,AxisName:A,NodeTest:U,Predicate:z,AbbreviatedAbsoluteLocationPath:w,AbbreviatedStep:v,AbbreviatedAxisSpecifier:t,Expr:s,PrimaryExpr:X,FunctionCall:O,UnionExpr:$,
PathExpr:E,FilterExpr:G,OrExpr:P,AndExpr:H,EqualityExpr:Q,RelationalExpr:M,AdditiveExpr:D,MultiplicativeExpr:I,UnaryExpr:L,Literal:W,Number:aa,Digits:J,MultiplyOperator:F,FunctionName:R,VariableReference:Z,NameTest:B,NodeType:ca,S:da,_:r,QName:S,PrefixedName:ba,UnprefixedName:N,NCName:function(){return V()},NameStartChar:Y,NameChar:k,Name:V};if(void 0!==g){if(void 0===l[g])throw Error("Invalid rule name: "+a(g)+".");}else g="XPath";var c=0,m=0,ea=0,ha=[],T=function(a,b,c,e){var f,g={type:"",args:[]};
g.args.push(a);for(a=0;a<b.length;a++){switch(typeof c){case "string":g.type=c;break;case "object":g.type=b[a][c[0]];for(f=1;f<c.length;f++)g.type=g.type[c[f]];break;default:g.type=b[a][c]}g.args.push("undefined"==typeof e?b[a]:b[a][e]);g={type:"",args:[g]}}return g.args[0]},ka=function(a,b,c,e){var f=[];if(1>c.length)return a;for(i=0;i<c.length;i++)f.push(c[i][e]);return{type:"predicate",args:[b,a,f]}},fa=[],ga=function(a){var b,c=!1;if(null!==a){for(b=0;b<fa.length;b++)if(fa[b]===a){c=!0;break}c||
fa.push(a)}},ja,ma=["comment","text","processing-instruction","node"],ia=function(a,b,c){return"/"==a?{type:"/",args:[b,c]}:{type:"/",args:[{type:"/",args:[b,{type:"step",args:["descendant-or-self",{type:"nodeType",args:["node",[]]}]}]},c]}},l=l[g]();if(null===l||c!==e.length){var l=Math.max(c,ea),qa=l<e.length?e.charAt(l):null,na=pa();throw new this.SyntaxError(oa(ha),qa,l,na.line,na.column);}return l},toSource:function(){return this._source},SyntaxError:function(e,g,b,f,q){this.name="SyntaxError";
this.expected=e;this.found=g;switch(e.length){case 0:e="end of input";break;case 1:e=e[0];break;default:e=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}g=g?a(g):"end of input";this.message="Expected "+e+" but "+g+" found.";this.offset=b;this.line=f;this.column=q}};g.SyntaxError.prototype=Error.prototype;return g}();
